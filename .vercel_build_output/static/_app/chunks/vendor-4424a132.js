function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function r(){return Object.create(null)}function i(e){e.forEach(n)}function o(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(e,t,n,r){if(e){const i=u(e,t,n,r);return e[0](i)}}function u(e,n,r,i){return e[1]&&i?t(r.ctx.slice(),e[1](i(n))):r.ctx}function l(e,t,n,r){if(e[2]&&r){const i=e[2](r(n));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],n=Math.max(t.dirty.length,i.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|i[r];return e}return t.dirty|i}return t.dirty}function c(e,t,n,r,i,o){if(i){const a=u(t,n,r,o);e.p(a,i)}}function h(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}let p,d=!1;function f(e,t,n,r){for(;e<t;){const i=e+(t-e>>1);n(i)<=r?e=i+1:t=i}return e}function _(e,t){if(d){for(!function(e){if(e.hydrate_init)return;e.hydrate_init=!0;let t=e.childNodes;if("HEAD"===e.nodeName){const e=[];for(let n=0;n<t.length;n++){const r=t[n];void 0!==r.claim_order&&e.push(r)}t=e}const n=new Int32Array(t.length+1),r=new Int32Array(t.length);n[0]=-1;let i=0;for(let u=0;u<t.length;u++){const e=t[u].claim_order,o=(i>0&&t[n[i]].claim_order<=e?i+1:f(1,i,(e=>t[n[e]].claim_order),e))-1;r[u]=n[o]+1;const a=o+1;n[a]=u,i=Math.max(a,i)}const o=[],a=[];let s=t.length-1;for(let u=n[i]+1;0!=u;u=r[u-1]){for(o.push(t[u-1]);s>=u;s--)a.push(t[s]);s--}for(;s>=0;s--)a.push(t[s]);o.reverse(),a.sort(((e,t)=>e.claim_order-t.claim_order));for(let u=0,l=0;u<a.length;u++){for(;l<o.length&&a[u].claim_order>=o[l].claim_order;)l++;const t=l<o.length?o[l]:null;e.insertBefore(a[u],t)}}(e),(void 0===e.actual_end_child||null!==e.actual_end_child&&e.actual_end_child.parentElement!==e)&&(e.actual_end_child=e.firstChild);null!==e.actual_end_child&&void 0===e.actual_end_child.claim_order;)e.actual_end_child=e.actual_end_child.nextSibling;t!==e.actual_end_child?void 0===t.claim_order&&t.parentNode===e||e.insertBefore(t,e.actual_end_child):e.actual_end_child=t.nextSibling}else t.parentNode===e&&null===t.nextSibling||e.appendChild(t)}function v(e,t,n){d&&!n?_(e,t):t.parentNode===e&&t.nextSibling==n||e.insertBefore(t,n||null)}function y(e){e.parentNode.removeChild(e)}function g(e){return document.createElement(e)}function m(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function w(e){return document.createTextNode(e)}function b(){return w(" ")}function C(){return w("")}function E(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function T(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function I(e){return Array.from(e.childNodes)}function S(e,t,n,r,i=!1){!function(e){void 0===e.claim_info&&(e.claim_info={last_index:0,total_claimed:0})}(e);const o=(()=>{for(let r=e.claim_info.last_index;r<e.length;r++){const o=e[r];if(t(o)){const t=n(o);return void 0===t?e.splice(r,1):e[r]=t,i||(e.claim_info.last_index=r),o}}for(let r=e.claim_info.last_index-1;r>=0;r--){const o=e[r];if(t(o)){const t=n(o);return void 0===t?e.splice(r,1):e[r]=t,i?void 0===t&&e.claim_info.last_index--:e.claim_info.last_index=r,o}}return r()})();return o.claim_order=e.claim_info.total_claimed,e.claim_info.total_claimed+=1,o}function k(e,t,n,r){return S(e,(e=>e.nodeName===t),(e=>{const t=[];for(let r=0;r<e.attributes.length;r++){const i=e.attributes[r];n[i.name]||t.push(i.name)}t.forEach((t=>e.removeAttribute(t)))}),(()=>r?m(t):g(t)))}function P(e,t){return S(e,(e=>3===e.nodeType),(e=>{const n=""+t;if(e.data.startsWith(n)){if(e.data.length!==n.length)return e.splitText(n.length)}else e.data=n}),(()=>w(t)),!0)}function N(e){return P(e," ")}function x(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function R(e,t){e.value=null==t?"":t}function A(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}function O(e,t=document.body){return Array.from(t.querySelectorAll(e))}function D(e){p=e}function L(){if(!p)throw new Error("Function called outside component initialization");return p}function F(e){L().$$.on_mount.push(e)}function M(e){L().$$.after_update.push(e)}function q(){const e=L();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const i=function(e,t,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,!1,t),r}(t,n);r.slice().forEach((t=>{t.call(e,i)}))}}}function j(e,t){L().$$.context.set(e,t)}const W=[],U=[],B=[],z=[],V=Promise.resolve();let H=!1;function $(){H||(H=!0,V.then(G))}function Q(e){B.push(e)}let Y=!1;const K=new Set;function G(){if(!Y){Y=!0;do{for(let e=0;e<W.length;e+=1){const t=W[e];D(t),J(t.$$)}for(D(null),W.length=0;U.length;)U.pop()();for(let e=0;e<B.length;e+=1){const t=B[e];K.has(t)||(K.add(t),t())}B.length=0}while(W.length);for(;z.length;)z.pop()();H=!1,Y=!1,K.clear()}}function J(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Q)}}const X=new Set;let Z;function ee(){Z={r:0,c:[],p:Z}}function te(){Z.r||i(Z.c),Z=Z.p}function ne(e,t){e&&e.i&&(X.delete(e),e.i(t))}function re(e,t,n,r){if(e&&e.o){if(X.has(e))return;X.add(e),Z.c.push((()=>{X.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}const ie="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function oe(e,t){const n={},r={},i={$$scope:1};let o=e.length;for(;o--;){const a=e[o],s=t[o];if(s){for(const e in a)e in s||(r[e]=1);for(const e in s)i[e]||(n[e]=s[e],i[e]=1);e[o]=s}else for(const e in a)i[e]=1}for(const a in r)a in n||(n[a]=void 0);return n}function ae(e){return"object"==typeof e&&null!==e?e:{}}function se(e){e&&e.c()}function ue(e,t){e&&e.l(t)}function le(e,t,r,a){const{fragment:s,on_mount:u,on_destroy:l,after_update:c}=e.$$;s&&s.m(t,r),a||Q((()=>{const t=u.map(n).filter(o);l?l.push(...t):i(t),e.$$.on_mount=[]})),c.forEach(Q)}function ce(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function he(t,n,o,a,s,u,l,c=[-1]){const h=p;D(t);const f=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:s,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:n.context||[]),callbacks:r(),dirty:c,skip_bound:!1,root:n.target||h.$$.root};l&&l(f.root);let _=!1;if(f.ctx=o?o(t,n.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&s(f.ctx[e],f.ctx[e]=i)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](i),_&&function(e,t){-1===e.$$.dirty[0]&&(W.push(e),$(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],f.update(),_=!0,i(f.before_update),f.fragment=!!a&&a(f.ctx),n.target){if(n.hydrate){d=!0;const e=I(n.target);f.fragment&&f.fragment.l(e),e.forEach(y)}else f.fragment&&f.fragment.c();n.intro&&ne(t.$$.fragment),le(t,n.target,n.anchor,n.customElement),d=!1,G()}D(h)}class pe{$destroy(){ce(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const de=[];function fe(t,n=e){let r;const i=new Set;function o(e){if(a(t,e)&&(t=e,r)){const e=!de.length;for(const n of i)n[1](),de.push(n,t);if(e){for(let e=0;e<de.length;e+=2)de[e][0](de[e+1]);de.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(a,s=e){const u=[a,s];return i.add(u),1===i.size&&(r=n(o)||e),a(t),()=>{i.delete(u),0===i.size&&(r(),r=null)}}}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _e=function(e,t){return(_e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function ve(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}_e(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var ye=function(){return(ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function ge(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function me(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function we(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function be(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function Ce(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee=!1,Te="${JSCORE_VERSION}",Ie=function(e,t){if(!e)throw Se(t)},Se=function(e){return new Error("Firebase Database ("+Te+") INTERNAL ASSERT FAILED: "+e)},ke=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Pe={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,l=u?e[i+2]:0,c=o>>2,h=(3&o)<<4|s>>4,p=(15&s)<<2|l>>6,d=63&l;u||(d=64,a||(p=64)),r.push(n[c],n[h],n[p],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(ke(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var l=o<<2|a>>4;if(r.push(l),64!==s){var c=a<<4&240|s>>2;if(r.push(c),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Ne=function(e){try{return Pe.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function xe(e){return Re(void 0,e)}function Re(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Re(e[n],t[n]));return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ae=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function De(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function Le(){return!0===Ee}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe=function(e){function t(n,r,i){var o=e.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,Me.prototype.create),o}return ve(t,e),t}(Error),Me=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?qe(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new Fe(i,s,r);return u},e}();function qe(e,t){return e.replace(je,(function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"}))}var je=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(e){return JSON.parse(e)}function Ue(e){return JSON.stringify(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=We(Ne(o[0])||""),n=We(Ne(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:t,claims:n,data:r,signature:i}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ze(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ve(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function He(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function $e(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Qe=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],l=this.chain_[2],c=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=c^u&(l^c),a=1518500249):(o=u^l^c,a=1859775393):r<60?(o=u&l|c&(u|l),a=2400959708):(o=u^l^c,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=c,c=l,l=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();function Ye(e,t){var n=new Ke(e,t);return n.subscribe.bind(n)}var Ke=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=Ge),void 0===r.error&&(r.error=Ge),void 0===r.complete&&(r.complete=Ge);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function Ge(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function Xe(e,t){return e+" failed: "+t+" argument "}function Ze(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(Xe(e,t)+"must be a valid function.")}function et(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(Xe(e,t)+"must be a valid context object.")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tt=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function nt(e){return e&&e._delegate?e._delegate:e}var rt=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),it=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Ae;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(c){}try{for(var r=we(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=be(i.value,2),a=o[0],s=o[1],u=this.normalizeInstanceIdentifier(a);try{var l=this.getOrInitializeService({instanceIdentifier:u});s.resolve(l)}catch(c){}}}catch(h){t={error:h}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e="[DEFAULT]"),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return ge(this,void 0,void 0,(function(){var e;return me(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(Ce(Ce([],be(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),be(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e="[DEFAULT]"),this.instances.has(e)},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var r=e.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var s=we(this.instancesDeferred.entries()),u=s.next();!u.done;u=s.next()){var l=be(u.value,2),c=l[0],h=l[1];o===this.normalizeInstanceIdentifier(c)&&h.resolve(a)}}catch(p){t={error:p}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return a},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&e(o,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,r,i=this.onInitCallbacks.get(t);if(i)try{for(var o=we(i),a=o.next();!a.done;a=o.next()){var s=a.value;try{s(e,t)}catch(u){}}}catch(l){n={error:l}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,"[DEFAULT]"===t?void 0:t),options:i}),this.instances.set(n,o),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(a){}return o||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e="[DEFAULT]"),this.component?this.component.multipleInstances?e:"[DEFAULT]":e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ot,at=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new it(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function st(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut,lt,ct=[];(lt=ut||(ut={}))[lt.DEBUG=0]="DEBUG",lt[lt.VERBOSE=1]="VERBOSE",lt[lt.INFO=2]="INFO",lt[lt.WARN=3]="WARN",lt[lt.ERROR=4]="ERROR",lt[lt.SILENT=5]="SILENT";var ht,pt={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},dt=ut.INFO,ft=((ot={})[ut.DEBUG]="log",ot[ut.VERBOSE]="log",ot[ut.INFO]="info",ot[ut.WARN]="warn",ot[ut.ERROR]="error",ot),_t=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=ft[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[o].apply(console,st(["["+i+"]  "+e.name+":"],n))}},vt=function(){function e(e){this.name=e,this._logLevel=dt,this._logHandler=_t,this._userLogHandler=null,ct.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in ut))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?pt[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,st([this,ut.DEBUG],e)),this._logHandler.apply(this,st([this,ut.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,st([this,ut.VERBOSE],e)),this._logHandler.apply(this,st([this,ut.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,st([this,ut.INFO],e)),this._logHandler.apply(this,st([this,ut.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,st([this,ut.WARN],e)),this._logHandler.apply(this,st([this,ut.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,st([this,ut.ERROR],e)),this._logHandler.apply(this,st([this,ut.ERROR],e))},e}();function yt(e){ct.forEach((function(t){t.setLogLevel(e)}))}var gt,mt=((ht={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",ht["bad-app-name"]="Illegal App name: '{$appName}",ht["duplicate-app"]="Firebase App named '{$appName}' already exists",ht["app-deleted"]="Firebase App named '{$appName}' already deleted",ht["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",ht["invalid-log-argument"]="First argument to `onLog` must be null or a function.",ht),wt=new Me("app","Firebase",mt),bt=((gt={})["@firebase/app"]="fire-core",gt["@firebase/analytics"]="fire-analytics",gt["@firebase/app-check"]="fire-app-check",gt["@firebase/auth"]="fire-auth",gt["@firebase/database"]="fire-rtdb",gt["@firebase/functions"]="fire-fn",gt["@firebase/installations"]="fire-iid",gt["@firebase/messaging"]="fire-fcm",gt["@firebase/performance"]="fire-perf",gt["@firebase/remote-config"]="fire-rc",gt["@firebase/storage"]="fire-gcs",gt["@firebase/firestore"]="fire-fst",gt["fire-js"]="fire-js",gt["firebase-wrapper"]="fire-js-all",gt),Ct=new vt("@firebase/app"),Et=function(){function e(e,t,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=xe(e),this.container=new at(t.name),this._addComponent(new rt("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(e){return r._addComponent(e)}))}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map((function(e){return e.delete()})))})).then((function(){e.isDeleted_=!0}))},e.prototype._getService=function(e,t){var n;void 0===t&&(t="[DEFAULT]"),this.checkDestroyed_();var r=this.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t="[DEFAULT]"),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){Ct.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw wt.create("app-deleted",{appName:this.name_})},e}();Et.prototype.name&&Et.prototype.options||Et.prototype.delete||console.log("dc");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Tt(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name="[DEFAULT]");var a=o.name;if("string"!=typeof a||!a)throw wt.create("bad-app-name",{appName:String(a)});if(ze(t,a))throw wt.create("duplicate-app",{appName:a});var s=new e(n,o,r);return t[a]=s,s},app:i,registerVersion:function(e,t,n){var r,i=null!==(r=bt[e])&&void 0!==r?r:e;n&&(i+="-"+n);var a=i.match(/\s|\//),s=t.match(/\s|\//);if(a||s){var u=['Unable to register library "'+i+'" with version "'+t+'":'];return a&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&s&&u.push("and"),s&&u.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void Ct.warn(u.join(" "))}o(new rt(i+"-version",(function(){return{library:i,version:t}}),"VERSION"))},setLogLevel:yt,onLog:function(e,t){if(null!==e&&"function"!=typeof e)throw wt.create("invalid-log-argument");!function(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=pt[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a=i.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:ut[n].toLowerCase(),message:a,args:i,type:t.name})}},r=0,i=ct;r<i.length;r++)n(i[r])}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t)},apps:null,SDK_VERSION:"8.8.1",INTERNAL:{registerComponent:o,removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){if("serverAuth"===t)return null;return t}}};function i(e){if(!ze(t,e=e||"[DEFAULT]"))throw wt.create("no-app",{appName:e});return t[e]}function o(o){var a=o.name;if(n.has(a))return Ct.debug("There were multiple attempts to register component "+a+"."),"PUBLIC"===o.type?r[a]:null;if(n.set(a,o),"PUBLIC"===o.type){var s=function(e){if(void 0===e&&(e=i()),"function"!=typeof e[a])throw wt.create("invalid-app-argument",{appName:a});return e[a]()};void 0!==o.serviceProps&&Re(s,o.serviceProps),r[a]=s,e.prototype[a]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._getService.bind(this,a);return n.apply(this,o.multipleInstances?e:[])}}for(var u=0,l=Object.keys(t);u<l.length;u++){var c=l[u];t[c]._addComponent(o)}return"PUBLIC"===o.type?r[a]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),i.App=e,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It=function e(){var t=Tt(Et);return t.INTERNAL=ye(ye({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Re(t,e)},createSubscribe:Ye,ErrorFactory:Me,deepExtend:Re}),t}(),St=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null})).filter((function(e){return e})).join(" ")},e}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Ct.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var kt=self.firebase.SDK_VERSION;kt&&kt.indexOf("LITE")>=0&&Ct.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Pt=It.initializeApp;It.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return De()&&Ct.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Pt.apply(void 0,e)};var Nt,xt,Rt=It;(Nt=Rt).INTERNAL.registerComponent(new rt("platform-logger",(function(e){return new St(e)}),"PRIVATE")),Nt.registerVersion("@firebase/app","0.6.29",xt),Nt.registerVersion("fire-js","");var At="";function Ot(e){At=e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt,Lt=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ue(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:We(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),Ft=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return ze(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),Mt=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Lt(t)}}catch(n){}return new Ft},qt=Mt("localStorage"),jt=Mt("sessionStorage"),Wt=new vt("@firebase/database"),Ut=(Dt=1,function(){return Dt++}),Bt=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,Ie(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new Qe;n.update(t);var r=n.digest();return Pe.encodeByteArray(r)},zt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++){var i=e[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=zt.apply(null,i):n+="object"==typeof i?Ue(i):i,n+=" "}return n},Vt=null,Ht=!0,$t=function(e,t){Ie(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Wt.logLevel=ut.VERBOSE,Vt=Wt.log.bind(Wt),t&&jt.set("logging_enabled",!0)):"function"==typeof e?Vt=e:(Vt=null,jt.remove("logging_enabled"))},Qt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===Ht&&(Ht=!1,null===Vt&&!0===jt.get("logging_enabled")&&$t(!0)),Vt){var n=zt.apply(null,e);Vt(n)}},Yt=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];Qt.apply(void 0,Ce([e],be(t)))}},Kt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+zt.apply(void 0,Ce([],be(e)));Wt.error(n)},Gt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+zt.apply(void 0,Ce([],be(e)));throw Wt.error(n),new Error(n)},Jt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+zt.apply(void 0,Ce([],be(e)));Wt.warn(n)},Xt=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Zt="[MIN_NAME]",en="[MAX_NAME]",tn=function(e,t){if(e===t)return 0;if(e===Zt||t===en)return-1;if(t===Zt||e===en)return 1;var n=cn(e),r=cn(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},nn=function(e,t){return e===t?0:e<t?-1:1},rn=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Ue(t))},on=function(e){if("object"!=typeof e||null===e)return Ue(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",i=0;i<t.length;i++)0!==i&&(r+=","),r+=Ue(t[i]),r+=":",r+=on(e[t[i]]);return r+="}"},an=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var un=function(e){Ie(!Xt(e),"Invalid JSON number");var t,n,r,i,o,a=1023;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),a))+a,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),l="";for(o=0;o<64;o+=8){var c=parseInt(u.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),l+=c}return l.toLowerCase()};var ln=new RegExp("^-?(0*)\\d{1,10}$"),cn=function(e){if(ln.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},hn=function(e){try{e()}catch(t){setTimeout((function(){var e=t.stack||"";throw Jt("Exception was thrown by user callback.",e),t}),Math.floor(0))}},pn=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},dn=function(){function e(e,t){var n=this;this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((function(e){return n.appCheck=e}))}return e.prototype.getToken=function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){setTimeout((function(){t.appCheck?t.getToken(e).then(n,r):n(null)}),0)}))},e.prototype.addTokenChangeListener=function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))},e.prototype.notifyForInvalidToken=function(){Jt('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},e}(),fn=function(){function e(e,t,n){var r=this;this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(e){return r.auth_=e}))}return e.prototype.getToken=function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(Qt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){setTimeout((function(){t.auth_?t.getToken(e).then(n,r):n(null)}),0)}))},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Jt(e)},e}(),_n=function(){function e(e){this.accessToken=e}return e.prototype.getToken=function(e){return Promise.resolve({accessToken:this.accessToken})},e.prototype.addTokenChangeListener=function(e){e(this.accessToken)},e.prototype.removeTokenChangeListener=function(e){},e.prototype.notifyForInvalidToken=function(){},e.OWNER="owner",e}(),vn=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,yn=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=qt.get("host:"+e)||this._host}return e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&qt.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+e+this.host+"/"+t},e}();function gn(e,t,n){var r;if(Ie("string"==typeof t,"typeof type must == string"),Ie("object"==typeof n,"typeof params must == object"),"websocket"===t)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if("long_polling"!==t)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return sn(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mn=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),ze(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return xe(this.counters_)},e}(),wn={},bn={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cn(e){var t=e.toString();return wn[t]||(wn[t]=new mn),wn[t]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var En=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&hn((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},e}(),Tn=function(){function e(e,t,n,r,i,o,a){var s=this;this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Yt(e),this.stats_=Cn(t),this.urlFn=function(e){return s.appCheckToken&&(e.ac=s.appCheckToken),gn(t,"long_polling",e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new En(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new In((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=be(e,5),i=r[0],o=r[1],a=r[2];if(r[3],r[4],n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=o,n.password=a;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=be(e,2),i=r[0],o=r[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&vn.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!!e.forceAllow_||!(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Ue(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n,r=(n=ke(t),Pe.encodeByteArray(n,!0)),i=an(r,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},e.prototype.incrementIncomingBytes_=function(e){var t=Ue(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),In=function(){function e(t,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=Ut(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(o='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(s){Qt("frame writing exception"),s.stack&&Qt(s.stack),Qt(s)}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Qt("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))},e.prototype.addTag=function(e,t){var n=this;setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){Qt("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},e}(),Sn=null;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */"undefined"!=typeof MozWebSocket?Sn=MozWebSocket:"undefined"!=typeof WebSocket&&(Sn=WebSocket);var kn=function(){function e(t,n,r,i,o,a,s){this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Yt(this.connId),this.stats_=Cn(n),this.connURL=e.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return e.connectionURL_=function(e,t,n,r){var i={v:"5"};return"undefined"!=typeof location&&location.hostname&&vn.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),gn(e,"websocket",i)},e.prototype.open=function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,qt.set("previous_websocket_failure",!0);try{if(Le());else{var r={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Sn(this.connURL,[],r)}}catch(o){this.log_("Error instantiating WebSocket.");var i=o.message||o.data;return i&&this.log_(i),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==Sn&&!e.forceDisallow_},e.previouslyFailed=function(){return qt.isInMemoryStorage||!0===qt.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){qt.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=We(t);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(Ie(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=Ue(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=an(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),Pn=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[Tn,kn]},enumerable:!1,configurable:!0}),e.prototype.initTransports_=function(t){var n,r,i=kn&&kn.isAvailable(),o=i&&!kn.previouslyFailed();if(t.webSocketOnly&&(i||Jt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[kn];else{var a=this.transports_=[];try{for(var s=we(e.ALL_TRANSPORTS),u=s.next();!u.done;u=s.next()){var l=u.value;l&&l.isAvailable()&&a.push(l)}}catch(c){n={error:c}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),Nn=function(){function e(e,t,n,r,i,o,a,s,u,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Yt("c:"+this.id+":"),this.transportManager_=new Pn(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=pn((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=rn("t",e),n=rn("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=rn("t",e),n=rn("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=rn("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Kt("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Kt("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&Jt("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),pn((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):pn((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(qt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),xn=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.refreshAppCheckToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),Rn=function(){function e(e){this.allowedEvents_=e,this.listeners_={},Ie(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=Ce([],be(this.listeners_[e])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){Ie(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)},e}(),An=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Oe()||(window.addEventListener("online",(function(){t.online_||(t.online_=!0,t.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){t.online_&&(t.online_=!1,t.trigger("online",!1))}),!1)),t}return ve(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Ie("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(Rn),On=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(){return new On("")}function Ln(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Fn(e){return e.pieces_.length-e.pieceNum_}function Mn(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new On(e.pieces_,t)}function qn(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function jn(e,t){return void 0===t&&(t=0),e.pieces_.slice(e.pieceNum_+t)}function Wn(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new On(t,0)}function Un(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof On)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new On(n,0)}function Bn(e){return e.pieceNum_>=e.pieces_.length}function zn(e,t){var n=Ln(e),r=Ln(t);if(null===n)return t;if(n===r)return zn(Mn(e),Mn(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Vn(e,t){for(var n=jn(e,0),r=jn(t,0),i=0;i<n.length&&i<r.length;i++){var o=tn(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Hn(e,t){if(Fn(e)!==Fn(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function $n(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(Fn(e)>Fn(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var Qn=function(e,t){this.errorPrefix_=t,this.parts_=jn(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=tt(this.parts_[n]);Yn(this)};function Yn(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Kn(e))}function Kn(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gn,Jn,Xn=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",t="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))}),!1),r}return ve(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Ie("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(Rn),Zn=function(e){function t(n,r,i,o,a,s,u,l){var c=e.call(this)||this;if(c.repoInfo_=n,c.applicationId_=r,c.onDataUpdate_=i,c.onConnectStatus_=o,c.onServerInfoUpdate_=a,c.authTokenProvider_=s,c.appCheckTokenProvider_=u,c.authOverride_=l,c.id=t.nextPersistentConnectionId_++,c.log_=Yt("p:"+c.id+":"),c.interruptReasons_={},c.listens=new Map,c.outstandingPuts_=[],c.outstandingGets_=[],c.outstandingPutCount_=0,c.outstandingGetCount_=0,c.onDisconnectRequestQueue_=[],c.connected_=!1,c.reconnectDelay_=1e3,c.maxReconnectDelay_=3e5,c.securityDebugCallback_=null,c.lastSessionId=null,c.establishConnectionTimer_=null,c.visible_=!1,c.requestCBHash_={},c.requestNumber_=0,c.realtime_=null,c.authToken_=null,c.appCheckToken_=null,c.forceTokenRefresh_=!1,c.invalidAuthTokenCount_=0,c.invalidAppCheckTokenCount_=0,c.firstConnection_=!0,c.lastConnectionAttemptTime_=null,c.lastConnectionEstablishedTime_=null,l&&!Le())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Xn.getInstance().on("visible",c.onVisible_,c),-1===n.host.indexOf("fblocal")&&An.getInstance().on("online",c.onOnline_,c),c}return ve(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Ue(i)),Ie(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},t.prototype.get=function(e){var t=this;this.initConnection_();var n=new Ae,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var e=t.outstandingGets_[o];void 0!==e&&i===e&&(delete t.outstandingGets_[o],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+o+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(o),n.promise},t.prototype.listen=function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),Ie(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ie(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},t.prototype.sendGet_=function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=r._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;t.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===e&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),e.onComplete&&e.onComplete(u,s))}))},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&ze(e,"w")){var n=Ve(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();Jt("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){var t;(e&&40===e.length||"object"==typeof(t=Be(e).claims)&&!0===t.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.refreshAppCheckToken=function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},t.prototype.tryAuth=function(){var e,t=this;if(this.connected_&&this.authToken_){var n=this.authToken_,r=(e=Be(n).claims)&&"object"==typeof e&&e.hasOwnProperty("iat")?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,(function(e){var r=e.s,i=e.d||"error";t.authToken_===n&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},t.prototype.tryAppCheck=function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))},t.prototype.unlisten=function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Ie(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){this.initConnection_();var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Ue(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Kt("Unrecognized action received from server: "+Ue(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;Ie(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))},t.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){return ge(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,l,c,h,p,d,f,_=this;return me(this,(function(v){switch(v.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,s=null,u=function(){s?s.close():(a=!0,r())},l=function(e){Ie(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(e)},this.realtime_={close:u,sendRequest:l},c=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,v.label=1;case 1:return v.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)])];case 2:return h=be.apply(void 0,[v.sent(),2]),p=h[0],d=h[1],a?Qt("getToken() completed but was canceled"):(Qt("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=d&&d.token,s=new Nn(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,(function(e){Jt(e+" ("+_.repoInfo_.toString()+")"),_.interrupt("server_kill")}),o)),[3,4];case 3:return f=v.sent(),this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&Jt(f),u()),[3,4];case 4:return[2]}}))}))},t.prototype.interrupt=function(e){Qt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){Qt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],He(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map((function(e){return on(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new On(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n},t.prototype.onAuthRevoked_=function(e,t){Qt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onAppCheckRevoked_=function(e,t){Qt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=we(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,we(a.values())),u=s.next();!u.done;u=s.next()){var l=u.value;this.sendListen_(l)}}catch(p){n={error:p}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(d){e={error:d}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var c=0;c<this.outstandingPuts_.length;c++)this.outstandingPuts_[c]&&this.sendPut_(c);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(c=0;c<this.outstandingGets_.length;c++)this.outstandingGets_[c]&&this.sendGet_(c)},t.prototype.sendConnectStats_=function(){var e={};e["sdk.js."+At.replace(/\./g,"-")]=1,Oe()?e["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=An.getInstance().currentlyOnline();return He(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(xn),er=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}(),tr=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new er(Zt,e),r=new er(Zt,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return er.MIN},e}(),nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ve(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return Gn},set:function(e){Gn=e},enumerable:!1,configurable:!0}),t.prototype.compare=function(e,t){return tn(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Se("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return er.MIN},t.prototype.maxPost=function(){return new er(en,Gn)},t.prototype.makePost=function(e,t){return Ie("string"==typeof e,"KeyIndex indexValue must always be a string."),new er(e,Gn)},t.prototype.toString=function(){return".key"},t}(tr),rr=new nr,ir=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),or=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:sr.EMPTY_NODE,this.right=null!=o?o:sr.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return sr.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return sr.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),ar=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new or(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),sr=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,or.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,or.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new ir(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new ir(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new ir(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new ir(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new ar,e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ur(e,t){return tn(e.name,t.name)}function lr(e,t){return tn(e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cr,hr,pr,dr=function(e){return"number"==typeof e?"number:"+un(e):"string:"+e},fr=function(e){if(e.isLeafNode()){var t=e.val();Ie("string"==typeof t||"number"==typeof t||"object"==typeof t&&ze(t,".sv"),"Priority must be a string or number.")}else Ie(e===Jn||e.isEmpty(),"priority of unexpected type.");Ie(e===Jn||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},_r=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,Ie(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),fr(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return cr},set:function(e){cr=e},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return Bn(t)?this:".priority"===Ln(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=Ln(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(Ie(".priority"!==r||1===Fn(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(Mn(t),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+dr(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?un(this.value_):this.value_,this.lazyHash_=Bt(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(Ie(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),o=e.VALUE_TYPE_ORDER.indexOf(r);return Ie(i>=0,"Unknown leaf type: "+n),Ie(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();var vr,yr,gr=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ve(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?tn(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return er.MIN},t.prototype.maxPost=function(){return new er(en,new _r("[PRIORITY-POST]",pr))},t.prototype.makePost=function(e,t){var n=hr(e);return new er(t,new _r("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(tr)),mr=Math.log(2),wr=function(){function e(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/mr,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=e+1&r}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),br=function(e,t,n,r){e.sort(t);var i=function(t,r){var o,a,s=r-t;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new or(a,o.node,or.BLACK,null,null);var u=parseInt(s/2,10)+t,l=i(t,u),c=i(u+1,r);return o=e[u],a=n?n(o):o,new or(a,o.node,or.BLACK,l,c)},o=function(t){for(var r=null,o=null,a=e.length,s=function(t,r){var o=a-t,s=a;a-=t;var l=i(o+1,s),c=e[o],h=n?n(c):c;u(new or(h,c.node,r,null,l))},u=function(e){r?(r.left=e,r=e):(o=e,r=e)},l=0;l<t.count;++l){var c=t.nextBitIsOne(),h=Math.pow(2,t.count-(l+1));c?s(h,or.BLACK):(s(h,or.BLACK),s(h,or.RED))}return o}(new wr(e.length));return new sr(r||t,o)},Cr={},Er=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return Ie(Cr&&gr,"ChildrenNode.ts has not been loaded"),vr=vr||new e({".priority":Cr},{".priority":gr})},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=Ve(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof sr?t:null},e.prototype.hasIndex=function(e){return ze(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){Ie(t!==rr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,a=n.getIterator(er.Wrap),s=a.getNext();s;)o=o||t.isDefinedOn(s.node),i.push(s),s=a.getNext();r=o?br(i,t.getCompare()):Cr;var u=t.toString(),l=ye({},this.indexSet_);l[u]=t;var c=ye({},this.indexes_);return c[u]=r,new e(c,l)},e.prototype.addToIndexes=function(t,n){var r=this;return new e($e(this.indexes_,(function(e,i){var o=Ve(r.indexSet_,i);if(Ie(o,"Missing index implementation for "+i),e===Cr){if(o.isDefinedOn(t.node)){for(var a=[],s=n.getIterator(er.Wrap),u=s.getNext();u;)u.name!==t.name&&a.push(u),u=s.getNext();return a.push(t),br(a,o.getCompare())}return Cr}var l=n.get(t.name),c=e;return l&&(c=c.remove(new er(t.name,l))),c.insert(t,t.node)})),this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){return new e($e(this.indexes_,(function(e){if(e===Cr)return e;var r=n.get(t.name);return r?e.remove(new er(t.name,r)):e})),this.indexSet_)},e}(),Tr=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&fr(this.priorityNode_),this.children_.isEmpty()&&Ie(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return yr||(yr=new e(new sr(lr),null,Er.Default))},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||yr},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?yr:t},e.prototype.getChild=function(e){var t=Ln(e);return null===t?this:this.getImmediateChild(t).getChild(Mn(e))},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if(Ie(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new er(t,n),i=void 0,o=void 0;n.isEmpty()?(i=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(t,n),o=this.indexMap_.addToIndexes(r,this.children_));var a=i.isEmpty()?yr:this.priorityNode_;return new e(i,a,o)},e.prototype.updateChild=function(e,t){var n=Ln(e);if(null===n)return t;Ie(".priority"!==Ln(e)||1===Fn(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(Mn(e),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(gr,(function(a,s){n[a]=s.val(t),r++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+dr(this.getPriority().val())+":"),this.forEachChild(gr,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Bt(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new er(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new er(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new er(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,er.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,er.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ir?-1:0},e.prototype.withIndex=function(t){if(t===rr||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===rr||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(gr),r=t.getIterator(gr),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===rr?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),Ir=new(function(e){function t(){return e.call(this,new sr(lr),Tr.EMPTY_NODE,Er.Default)||this}return ve(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return Tr.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(Tr));Object.defineProperties(er,{MIN:{value:new er(Zt,Tr.EMPTY_NODE)},MAX:{value:new er(en,Ir)}}),nr.__EMPTY_NODE=Tr.EMPTY_NODE,_r.__childrenNodeConstructor=Tr,Jn=Ir,function(e){pr=e}(Ir);function Sr(e,t){if(void 0===t&&(t=null),null===e)return Tr.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Ie(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new _r(e,Sr(t));if(e instanceof Array){var n=Tr.EMPTY_NODE;return sn(e,(function(t,r){if(ze(e,t)&&"."!==t.substring(0,1)){var i=Sr(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(t,i))}})),n.updatePriority(Sr(t))}var r=[],i=!1;if(sn(e,(function(e,t){if("."!==e.substring(0,1)){var n=Sr(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new er(e,n)))}})),0===r.length)return Tr.EMPTY_NODE;var o=br(r,ur,(function(e){return e.name}),lr);if(i){var a=br(r,gr.getCompare());return new Tr(o,Sr(t),new Er({".priority":a},{".priority":gr}))}return new Tr(o,Sr(t),Er.Default)}!function(e){hr=e}(Sr);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var kr,Pr,Nr=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,Ie(!Bn(t)&&".priority"!==Ln(t),"Can't create PathIndex with empty path or .priority key"),n}return ve(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?tn(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=Sr(e),r=Tr.EMPTY_NODE.updateChild(this.indexPath_,n);return new er(t,r)},t.prototype.maxPost=function(){var e=Tr.EMPTY_NODE.updateChild(this.indexPath_,Ir);return new er(en,e)},t.prototype.toString=function(){return jn(this.indexPath_,0).join("/")},t}(tr),xr=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ve(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?tn(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return er.MIN},t.prototype.maxPost=function(){return er.MAX},t.prototype.makePost=function(e,t){var n=Sr(e);return new er(t,n)},t.prototype.toString=function(){return".value"},t}(tr)),Rr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Ar=(kr=0,Pr=[],function(e){var t,n=e===kr;kr=e;var r=new Array(8);for(t=7;t>=0;t--)r[t]=Rr.charAt(e%64),e=Math.floor(e/64);Ie(0===e,"Cannot push at time == 0");var i=r.join("");if(n){for(t=11;t>=0&&63===Pr[t];t--)Pr[t]=0;Pr[t]++}else for(t=0;t<12;t++)Pr[t]=Math.floor(64*Math.random());for(t=0;t<12;t++)i+=Rr.charAt(Pr[t]);return Ie(20===i.length,"nextPushId: Length should be 20."),i}),Or=function(e){if("2147483647"===e)return"-";var t=cn(e);if(null!=t)return""+(t+1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return en;var o=n[i],a=Rr.charAt(Rr.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},Dr=function(e){if("-2147483648"===e)return Zt;var t=cn(e);if(null!=t)return""+(t-1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=Rr.charAt(Rr.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Lr(e){return{type:"value",snapshotNode:e}}function Fr(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Mr(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function qr(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var jr=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,i,o){Ie(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(Mr(t,a)):Ie(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Fr(t,n)):o.trackChildChange(qr(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(gr,(function(e,r){t.hasChild(e)||n.trackChildChange(Mr(e,r))})),t.isLeafNode()||t.forEachChild(gr,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(qr(t,r,i))}else n.trackChildChange(Fr(t,r))}))),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?Tr.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),Wr=function(){function e(t){this.indexedFilter_=new jr(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new er(t,n))||(n=Tr.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=Tr.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(Tr.EMPTY_NODE);var i=this;return t.forEachChild(gr,(function(e,t){i.matches(new er(e,t))||(r=r.updateImmediateChild(e,Tr.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),Ur=function(){function e(e){this.rangedFilter_=new Wr(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new er(t,n))||(n=Tr.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Tr.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=Tr.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(Tr.EMPTY_NODE);var s=void 0,u=void 0,l=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var c=this.index_.getCompare();l=function(e,t){return c(t,e)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();){a=i.getNext();!h&&l(s,a)<=0&&(h=!0),h&&o<this.limit_&&l(a,u)<=0?o++:r=r.updateImmediateChild(a.name,Tr.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(e,t){return a(t,e)}}else o=this.index_.getCompare();var s=e;Ie(s.numChildren()===this.limit_,"");var u=new er(t,n),l=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),c=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var h=s.getImmediateChild(t),p=r.getChildAfterChild(this.index_,l,this.reverse_);null!=p&&(p.name===t||s.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);var d=null==p?1:o(p,u);if(c&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(qr(t,n,h)),s.updateImmediateChild(t,n);null!=i&&i.trackChildChange(Mr(t,h));var f=s.updateImmediateChild(t,Tr.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=i&&i.trackChildChange(Fr(p.name,p.node)),f.updateImmediateChild(p.name,p.node)):f}return n.isEmpty()?e:c&&o(l,u)>=0?(null!=i&&(i.trackChildChange(Mr(l.name,l.node)),i.trackChildChange(Fr(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(l.name,Tr.EMPTY_NODE)):e},e}(),Br=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=gr}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.hasStartAfter=function(){return this.startAfterSet_},e.prototype.hasEndBefore=function(){return this.endBeforeSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},e.prototype.getIndexStartValue=function(){return Ie(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return Ie(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Zt},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return Ie(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return Ie(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:en},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return Ie(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===gr},e.prototype.copy=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Vr(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Hr(e,t){var n=e.copy();return n.index_=t,n}function $r(e){var t,n={};return e.isDefault()||(e.index_===gr?t="$priority":e.index_===xr?t="$value":e.index_===rr?t="$key":(Ie(e.index_ instanceof Nr,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Ue(t),e.startSet_&&(n.startAt=Ue(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+Ue(e.indexStartName_))),e.endSet_&&(n.endAt=Ue(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+Ue(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function Qr(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==gr&&(t.i=e.index_.toString()),t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yr=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.repoInfo_=t,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=Yt("p:rest:"),o.listens_={},o}return ve(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(Ie(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())},t.prototype.listen=function(e,n,r,i){var o=this,a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);var s=t.getListenId_(e,r),u={};this.listens_[s]=u;var l=$r(e._queryParams);this.restRequest_(a+".json",l,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&o.onDataUpdate_(a,n,!1,r),Ve(o.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.get=function(e){var t=this,n=$r(e._queryParams),r=e._path.toString(),i=new Ae;return this.restRequest_(r+".json",n,(function(e,n){var o=n;404===e&&(o=null,e=null),null===e?(t.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;return void 0===t&&(t={}),t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var o=be(i,2),a=o[0],s=o[1];a&&a.accessToken&&(t.auth=a.accessToken),s&&s.token&&(t.ac=s.token);var u=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+function(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""}(t);r.log_("Sending REST request for "+u);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(n&&4===l.readyState){r.log_("REST Response for "+u+" received. status:",l.status,"response:",l.responseText);var e=null;if(l.status>=200&&l.status<300){try{e=We(l.responseText)}catch(t){Jt("Failed to parse JSON response for "+u+": "+l.responseText)}n(null,e)}else 401!==l.status&&404!==l.status&&Jt("Got unsuccessful REST response for "+u+" Status: "+l.status),n(l.status);n=null}},l.open("GET",u,!0),l.send()}))},t}(xn),Kr=function(){function e(){this.rootNode_=Tr.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Gr(){return{value:null,children:new Map}}function Jr(e,t,n){if(Bn(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=Ln(t);e.children.has(r)||e.children.set(r,Gr()),Jr(e.children.get(r),t=Mn(t),n)}}function Xr(e,t){if(Bn(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(gr,(function(t,n){Jr(e,new On(t),n)})),Xr(e,t)}if(e.children.size>0){var r=Ln(t);if(t=Mn(t),e.children.has(r))Xr(e.children.get(r),t)&&e.children.delete(r);return 0===e.children.size}return!0}function Zr(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,(function(e,r){Zr(r,new On(t.toString()+"/"+e),n)}))}var ei,ti,ni=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=ye({},e);return this.last_&&sn(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t},e}(),ri=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ni(e);var n=1e4+2e4*Math.random();pn(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},r=!1;sn(t,(function(t,i){i>0&&ze(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),pn(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(ti=ei||(ei={}))[ti.OVERWRITE=0]="OVERWRITE",ti[ti.MERGE=1]="MERGE",ti[ti.ACK_USER_WRITE=2]="ACK_USER_WRITE",ti[ti.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var oi,ai=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=ei.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return e.prototype.operationForChild=function(t){if(Bn(this.path)){if(null!=this.affectedTree.value)return Ie(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new On(t));return new e(Dn(),n,this.revert)}return Ie(Ln(this.path)===t,"operationForChild called for unrelated child."),new e(Mn(this.path),this.affectedTree,this.revert)},e}(),si=function(){function e(e,t){this.source=e,this.path=t,this.type=ei.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return Bn(this.path)?new e(this.source,Dn()):new e(this.source,Mn(this.path))},e}(),ui=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=ei.OVERWRITE}return e.prototype.operationForChild=function(t){return Bn(this.path)?new e(this.source,Dn(),this.snap.getImmediateChild(t)):new e(this.source,Mn(this.path),this.snap)},e}(),li=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=ei.MERGE}return e.prototype.operationForChild=function(t){if(Bn(this.path)){var n=this.children.subtree(new On(t));return n.isEmpty()?null:n.value?new ui(this.source,Dn(),n.value):new e(this.source,Dn(),n)}return Ie(Ln(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,Mn(this.path),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),ci=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(Bn(e))return this.isFullyInitialized()&&!this.filtered_;var t=Ln(e);return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),hi=function(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(e,t,n,r,i,o){var a=r.filter((function(e){return e.type===n}));a.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw Se("Should only compare child_ events.");var r=new er(t.childName,t.snapshotNode),i=new er(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,n)})),a.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,o);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function di(e,t){return{eventCache:e,serverCache:t}}function fi(e,t,n,r){return di(new ci(t,n,r),e.serverCache)}function _i(e,t,n,r){return di(e.eventCache,new ci(t,n,r))}function vi(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function yi(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gi=function(){function e(e,t){void 0===t&&(oi||(oi=new sr(nn)),t=oi),this.value=e,this.children=t}return e.fromObject=function(t){var n=new e(null);return sn(t,(function(e,t){n=n.set(new On(e),t)})),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:Dn(),value:this.value};if(Bn(e))return null;var n=Ln(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(Mn(e),t);return null!=i?{path:Un(new On(n),i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))},e.prototype.subtree=function(t){if(Bn(t))return this;var n=Ln(t),r=this.children.get(n);return null!==r?r.subtree(Mn(t)):new e(null)},e.prototype.set=function(t,n){if(Bn(t))return new e(n,this.children);var r=Ln(t),i=(this.children.get(r)||new e(null)).set(Mn(t),n),o=this.children.insert(r,i);return new e(this.value,o)},e.prototype.remove=function(t){if(Bn(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=Ln(t),r=this.children.get(n);if(r){var i=r.remove(Mn(t)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new e(null):new e(this.value,o)}return this},e.prototype.get=function(e){if(Bn(e))return this.value;var t=Ln(e),n=this.children.get(t);return n?n.get(Mn(e)):null},e.prototype.setTree=function(t,n){if(Bn(t))return n;var r=Ln(t),i=(this.children.get(r)||new e(null)).setTree(Mn(t),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new e(this.value,o)},e.prototype.fold=function(e){return this.fold_(Dn(),e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Un(e,r),t)})),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,Dn(),t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(Bn(e))return null;var i=Ln(e),o=this.children.get(i);return o?o.findOnPath_(Mn(e),Un(t,i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,Dn(),t)},e.prototype.foreachOnPath_=function(t,n,r){if(Bn(t))return this;this.value&&r(n,this.value);var i=Ln(t),o=this.children.get(i);return o?o.foreachOnPath_(Mn(t),Un(n,i),r):new e(null)},e.prototype.foreach=function(e){this.foreach_(Dn(),e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(Un(e,n),t)})),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))},e}(),mi=function(){function e(e){this.writeTree_=e}return e.empty=function(){return new e(new gi(null))},e}();function wi(e,t,n){if(Bn(t))return new mi(new gi(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,a=zn(i,t);return o=o.updateChild(a,n),new mi(e.writeTree_.set(i,o))}var s=new gi(n),u=e.writeTree_.setTree(t,s);return new mi(u)}function bi(e,t,n){var r=e;return sn(n,(function(e,n){r=wi(r,Un(t,e),n)})),r}function Ci(e,t){if(Bn(t))return mi.empty();var n=e.writeTree_.setTree(t,new gi(null));return new mi(n)}function Ei(e,t){return null!=Ti(e,t)}function Ti(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(zn(n.path,t)):null}function Ii(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(gr,(function(e,n){t.push(new er(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new er(e,n.value))})),t}function Si(e,t){if(Bn(t))return e;var n=Ti(e,t);return new mi(null!=n?new gi(n):e.writeTree_.subtree(t))}function ki(e){return e.writeTree_.isEmpty()}function Pi(e,t){return Ni(Dn(),e.writeTree_,t)}function Ni(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(Ie(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Ni(Un(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Un(e,".priority"),r)),n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xi(e,t){return zi(t,e)}function Ri(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));Ie(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,o=!1,a=e.allWrites.length-1;i&&a>=0;){var s=e.allWrites[a];s.visible&&(a>=n&&Ai(s,r.path)?i=!1:$n(r.path,s.path)&&(o=!0)),a--}if(i){if(o)return function(e){e.visibleWrites=Di(e.allWrites,Oi,Dn()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=Ci(e.visibleWrites,r.path):sn(r.children,(function(t){e.visibleWrites=Ci(e.visibleWrites,Un(r.path,t))}));return!0}return!1}function Ai(e,t){if(e.snap)return $n(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&$n(Un(e.path,n),t))return!0;return!1}function Oi(e){return e.visible}function Di(e,t,n){for(var r=mi.empty(),i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,s=void 0;if(o.snap)$n(n,a)?r=wi(r,s=zn(n,a),o.snap):$n(a,n)&&(s=zn(a,n),r=wi(r,Dn(),o.snap.getChild(s)));else{if(!o.children)throw Se("WriteRecord should have .snap or .children");if($n(n,a))r=bi(r,s=zn(n,a),o.children);else if($n(a,n))if(Bn(s=zn(a,n)))r=bi(r,Dn(),o.children);else{var u=Ve(o.children,Ln(s));if(u){var l=u.getChild(Mn(s));r=wi(r,Dn(),l)}}}}}return r}function Li(e,t,n,r,i){if(r||i){var o=Si(e.visibleWrites,t);if(!i&&ki(o))return n;if(i||null!=n||Ei(o,Dn())){return Pi(Di(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&($n(e.path,t)||$n(t,e.path))}),t),n||Tr.EMPTY_NODE)}return null}var a=Ti(e.visibleWrites,t);if(null!=a)return a;var s=Si(e.visibleWrites,t);return ki(s)?n:null!=n||Ei(s,Dn())?Pi(s,n||Tr.EMPTY_NODE):null}function Fi(e,t,n,r){return Li(e.writeTree,e.treePath,t,n,r)}function Mi(e,t){return function(e,t,n){var r=Tr.EMPTY_NODE,i=Ti(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(gr,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var o=Si(e.visibleWrites,t);return n.forEachChild(gr,(function(e,t){var n=Pi(Si(o,new On(e)),t);r=r.updateImmediateChild(e,n)})),Ii(o).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return Ii(Si(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function qi(e,t,n,r){return function(e,t,n,r,i){Ie(r||i,"Either existingEventSnap or existingServerSnap must exist");var o=Un(t,n);if(Ei(e.visibleWrites,o))return null;var a=Si(e.visibleWrites,o);return ki(a)?i.getChild(n):Pi(a,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function ji(e,t){return function(e,t){return Ti(e.visibleWrites,t)}(e.writeTree,Un(e.treePath,t))}function Wi(e,t,n,r,i,o){return function(e,t,n,r,i,o,a){var s,u=Si(e.visibleWrites,t),l=Ti(u,Dn());if(null!=l)s=l;else{if(null==n)return[];s=Pi(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var c=[],h=a.getCompare(),p=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),d=p.getNext();d&&c.length<i;)0!==h(d,r)&&c.push(d),d=p.getNext();return c}(e.writeTree,e.treePath,t,n,r,i,o)}function Ui(e,t,n){return function(e,t,n,r){var i=Un(t,n),o=Ti(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?Pi(Si(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function Bi(e,t){return zi(Un(e.treePath,t),e.writeTree)}function zi(e,t){return{treePath:e,writeTree:t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vi=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;Ie("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Ie(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,qr(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,Mr(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Fr(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Se("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,qr(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),Hi=new(function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}()),$i=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new ci(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ui(this.writes_,e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:yi(this.viewCache_),i=Wi(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qi(e,t,n,r,i){var o,a,s=new Vi;if(n.type===ei.OVERWRITE){var u=n;u.source.fromUser?o=Gi(e,t,u.path,u.snap,r,i,s):(Ie(u.source.fromServer,"Unknown source."),a=u.source.tagged||t.serverCache.isFiltered()&&!Bn(u.path),o=Ki(e,t,u.path,u.snap,r,i,a,s))}else if(n.type===ei.MERGE){var l=n;l.source.fromUser?o=function(e,t,n,r,i,o,a){var s=t;return r.foreach((function(r,u){var l=Un(n,r);Ji(t,Ln(l))&&(s=Gi(e,s,l,u,i,o,a))})),r.foreach((function(r,u){var l=Un(n,r);Ji(t,Ln(l))||(s=Gi(e,s,l,u,i,o,a))})),s}(e,t,l.path,l.children,r,i,s):(Ie(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),o=Zi(e,t,l.path,l.children,r,i,a,s))}else if(n.type===ei.ACK_USER_WRITE){var c=n;o=c.revert?function(e,t,n,r,i,o){var a;if(null!=ji(r,n))return t;var s=new $i(r,t,i),u=t.eventCache.getNode(),l=void 0;if(Bn(n)||".priority"===Ln(n)){var c=void 0;if(t.serverCache.isFullyInitialized())c=Fi(r,yi(t));else{var h=t.serverCache.getNode();Ie(h instanceof Tr,"serverChildren would be complete if leaf node"),c=Mi(r,h)}c=c,l=e.filter.updateFullNode(u,c,o)}else{var p=Ln(n),d=Ui(r,p,t.serverCache);null==d&&t.serverCache.isCompleteForChild(p)&&(d=u.getImmediateChild(p)),(l=null!=d?e.filter.updateChild(u,p,d,Mn(n),s,o):t.eventCache.getNode().hasChild(p)?e.filter.updateChild(u,p,Tr.EMPTY_NODE,Mn(n),s,o):u).isEmpty()&&t.serverCache.isFullyInitialized()&&(a=Fi(r,yi(t))).isLeafNode()&&(l=e.filter.updateFullNode(l,a,o))}return a=t.serverCache.isFullyInitialized()||null!=ji(r,Dn()),fi(t,l,a,e.filter.filtersNodes())}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,c.path,r,i,s):function(e,t,n,r,i,o,a){if(null!=ji(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(Bn(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Ki(e,t,n,u.getNode().getChild(n),i,o,s,a);if(Bn(n)){var l=new gi(null);return u.getNode().forEachChild(rr,(function(e,t){l=l.set(new On(e),t)})),Zi(e,t,n,l,i,o,s,a)}return t}var c=new gi(null);return r.foreach((function(e,t){var r=Un(n,e);u.isCompleteForPath(r)&&(c=c.set(e,u.getNode().getChild(r)))})),Zi(e,t,n,c,i,o,s,a)}(e,t,c.path,c.affectedTree,r,i,s)}else{if(n.type!==ei.LISTEN_COMPLETE)throw Se("Unknown operation type: "+n.type);o=function(e,t,n,r,i){var o=t.serverCache,a=_i(t,o.getNode(),o.isFullyInitialized()||Bn(n),o.isFiltered());return Yi(e,a,n,r,Hi,i)}(e,t,n.path,r,s)}var h=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=vi(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Lr(vi(t)))}}(t,o,h),{viewCache:o,changes:h}}function Yi(e,t,n,r,i,o){var a=t.eventCache;if(null!=ji(r,n))return t;var s=void 0,u=void 0;if(Bn(n))if(Ie(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var l=yi(t),c=Mi(r,l instanceof Tr?l:Tr.EMPTY_NODE);s=e.filter.updateFullNode(t.eventCache.getNode(),c,o)}else{var h=Fi(r,yi(t));s=e.filter.updateFullNode(t.eventCache.getNode(),h,o)}else{var p=Ln(n);if(".priority"===p){Ie(1===Fn(n),"Can't have a priority with additional path components");var d=a.getNode(),f=qi(r,n,d,u=t.serverCache.getNode());s=null!=f?e.filter.updatePriority(d,f):a.getNode()}else{var _=Mn(n),v=void 0;if(a.isCompleteForChild(p)){u=t.serverCache.getNode();var y=qi(r,n,a.getNode(),u);v=null!=y?a.getNode().getImmediateChild(p).updateChild(_,y):a.getNode().getImmediateChild(p)}else v=Ui(r,p,t.serverCache);s=null!=v?e.filter.updateChild(a.getNode(),p,v,_,i,o):a.getNode()}}return fi(t,s,a.isFullyInitialized()||Bn(n),e.filter.filtersNodes())}function Ki(e,t,n,r,i,o,a,s){var u,l=t.serverCache,c=a?e.filter:e.filter.getIndexedFilter();if(Bn(n))u=c.updateFullNode(l.getNode(),r,null);else if(c.filtersNodes()&&!l.isFiltered()){var h=l.getNode().updateChild(n,r);u=c.updateFullNode(l.getNode(),h,null)}else{var p=Ln(n);if(!l.isCompleteForPath(n)&&Fn(n)>1)return t;var d=Mn(n),f=l.getNode().getImmediateChild(p).updateChild(d,r);u=".priority"===p?c.updatePriority(l.getNode(),f):c.updateChild(l.getNode(),p,f,d,Hi,null)}var _=_i(t,u,l.isFullyInitialized()||Bn(n),c.filtersNodes());return Yi(e,_,n,i,new $i(i,_,o),s)}function Gi(e,t,n,r,i,o,a){var s,u,l=t.eventCache,c=new $i(i,t,o);if(Bn(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,a),s=fi(t,u,!0,e.filter.filtersNodes());else{var h=Ln(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=fi(t,u,l.isFullyInitialized(),l.isFiltered());else{var p=Mn(n),d=l.getNode().getImmediateChild(h),f=void 0;if(Bn(p))f=r;else{var _=c.getCompleteChild(h);f=null!=_?".priority"===qn(p)&&_.getChild(Wn(p)).isEmpty()?_:_.updateChild(p,r):Tr.EMPTY_NODE}if(d.equals(f))s=t;else s=fi(t,e.filter.updateChild(l.getNode(),h,f,p,c,a),l.isFullyInitialized(),e.filter.filtersNodes())}}return s}function Ji(e,t){return e.eventCache.isCompleteForChild(t)}function Xi(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function Zi(e,t,n,r,i,o,a,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,l=t;u=Bn(n)?r:new gi(null).setTree(n,r);var c=t.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(c.hasChild(n)){var u=Xi(0,t.serverCache.getNode().getImmediateChild(n),r);l=Ki(e,l,new On(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!c.hasChild(n)&&!u){var h=Xi(0,t.serverCache.getNode().getImmediateChild(n),r);l=Ki(e,l,new On(n),h,i,o,a,s)}})),l}var eo,to=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new jr(r.getIndex()),o=(n=r).loadsAllData()?new jr(n.getIndex()):n.hasLimit()?new Ur(n):new Wr(n);this.processor_=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){return{filter:e}}(o);var a=t.serverCache,s=t.eventCache,u=i.updateFullNode(Tr.EMPTY_NODE,a.getNode(),null),l=o.updateFullNode(Tr.EMPTY_NODE,s.getNode(),null),c=new ci(u,a.isFullyInitialized(),i.filtersNodes()),h=new ci(l,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=di(h,c),this.eventGenerator_=new hi(this.query_)}return Object.defineProperty(e.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),e}();function no(e,t){var n=yi(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Bn(t)&&!n.getImmediateChild(Ln(t)).isEmpty())?n.getChild(t):null}function ro(e){return 0===e.eventRegistrations_.length}function io(e,t,n){var r=[];if(n){Ie(null==t,"A cancel should cancel all event registrations.");var i=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){for(var o=[],a=0;a<e.eventRegistrations_.length;++a){var s=e.eventRegistrations_[a];if(s.matches(t)){if(t.hasAnyCallback()){o=o.concat(e.eventRegistrations_.slice(a+1));break}}else o.push(s)}e.eventRegistrations_=o}else e.eventRegistrations_=[];return r}function oo(e,t,n,r){t.type===ei.MERGE&&null!==t.source.queryId&&(Ie(yi(e.viewCache_),"We should always have a full cache before handling merges"),Ie(vi(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,o,a=e.viewCache_,s=Qi(e.processor_,a,t,n,r);return i=e.processor_,o=s.viewCache,Ie(o.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),Ie(o.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),Ie(s.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,ao(e,s.changes,s.viewCache.eventCache.getNode(),null)}function ao(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],o=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),pi(e,i,"child_removed",t,r,n),pi(e,i,"child_added",t,r,n),pi(e,i,"child_moved",o,r,n),pi(e,i,"child_changed",t,r,n),pi(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var so,uo=function(){this.views=new Map};function lo(e,t,n,r){var i,o,a=t.source.queryId;if(null!==a){var s=e.views.get(a);return Ie(null!=s,"SyncTree gave us an op for an invalid query."),oo(s,t,n,r)}var u=[];try{for(var l=we(e.views.values()),c=l.next();!c.done;c=l.next()){s=c.value;u=u.concat(oo(s,t,n,r))}}catch(h){i={error:h}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return u}function co(e,t,n,r,i){var o=t._queryIdentifier,a=e.views.get(o);if(!a){var s=Fi(n,i?r:null),u=!1;s?u=!0:r instanceof Tr?(s=Mi(n,r),u=!1):(s=Tr.EMPTY_NODE,u=!1);var l=di(new ci(s,u,!1),new ci(r,i,!1));return new to(t,l)}return a}function ho(e,t,n,r,i,o){var a=co(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),function(e,t){e.eventRegistrations_.push(t)}(a,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(gr,(function(e,t){r.push(Fr(e,t))})),n.isFullyInitialized()&&r.push(Lr(n.getNode())),ao(e,r,n.getNode(),t)}(a,n)}function po(e,t,n,r){var i,o,a=t._queryIdentifier,s=[],u=[],l=go(e);if("default"===a)try{for(var c=we(e.views.entries()),h=c.next();!h.done;h=c.next()){var p=be(h.value,2),d=p[0],f=p[1];u=u.concat(io(f,n,r)),ro(f)&&(e.views.delete(d),f.query._queryParams.loadsAllData()||s.push(f.query))}}catch(_){i={error:_}}finally{try{h&&!h.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}else(f=e.views.get(a))&&(u=u.concat(io(f,n,r)),ro(f)&&(e.views.delete(a),f.query._queryParams.loadsAllData()||s.push(f.query)));return l&&!go(e)&&s.push(new(Ie(eo,"Reference.ts has not been loaded"),eo)(t._repo,t._path)),{removed:s,events:u}}function fo(e){var t,n,r=[];try{for(var i=we(e.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;a.query._queryParams.loadsAllData()||r.push(a)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function _o(e,t){var n,r,i=null;try{for(var o=we(e.views.values()),a=o.next();!a.done;a=o.next()){var s=a.value;i=i||no(s,t)}}catch(u){n={error:u}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function vo(e,t){if(t._queryParams.loadsAllData())return mo(e);var n=t._queryIdentifier;return e.views.get(n)}function yo(e,t){return null!=vo(e,t)}function go(e){return null!=mo(e)}function mo(e){var t,n;try{for(var r=we(e.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(a){t={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wo=1,bo=function(e){this.listenProvider_=e,this.syncPointTree_=new gi(null),this.pendingWriteTree_={visibleWrites:mi.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function Co(e,t,n,r,i){return function(e,t,n,r,i){Ie(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=wi(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?xo(e,new ui({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Eo(e,t,n,r){!function(e,t,n,r){Ie(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=bi(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var i=gi.fromObject(n);return xo(e,new li({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function To(e,t,n){void 0===n&&(n=!1);var r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(Ri(e.pendingWriteTree_,t)){var i=new gi(null);return null!=r.snap?i=i.set(Dn(),!0):sn(r.children,(function(e){i=i.set(new On(e),!0)})),xo(e,new ai(r.path,i,n))}return[]}function Io(e,t,n){return xo(e,new ui({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function So(e,t,n,r){var i=t._path,o=e.syncPointTree_.get(i),a=[];if(o&&("default"===t._queryIdentifier||yo(o,t))){var s=po(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));var u=s.removed;a=s.events;var l=-1!==u.findIndex((function(e){return e._queryParams.loadsAllData()})),c=e.syncPointTree_.findOnPath(i,(function(e,t){return go(t)}));if(l&&!c){var h=e.syncPointTree_.subtree(i);if(!h.isEmpty())for(var p=function(e){return e.fold((function(e,t,n){if(t&&go(t))return[mo(t)];var r=[];return t&&(r=fo(t)),sn(n,(function(e,t){r=r.concat(t)})),r}))}(h),d=0;d<p.length;++d){var f=p[d],_=f.query,v=Oo(e,f);e.listenProvider_.startListening(jo(_),Do(e,_),v.hashFn,v.onComplete)}}if(!c&&u.length>0&&!r)if(l){e.listenProvider_.stopListening(jo(t),null)}else u.forEach((function(t){var n=e.queryToTagMap.get(Lo(t));e.listenProvider_.stopListening(jo(t),n)}));!function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=Lo(r),o=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(o)}}}(e,u)}return a}function ko(e,t,n){var r=t._path,i=null,o=!1;e.syncPointTree_.foreachOnPath(r,(function(e,t){var n=zn(e,r);i=i||_o(t,n),o=o||go(t)}));var a,s=e.syncPointTree_.get(r);(s?(o=o||go(s),i=i||_o(s,Dn())):(s=new uo,e.syncPointTree_=e.syncPointTree_.set(r,s)),null!=i)?a=!0:(a=!1,i=Tr.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild((function(e,t){var n=_o(t,Dn());n&&(i=i.updateImmediateChild(e,n))})));var u=yo(s,t);if(!u&&!t._queryParams.loadsAllData()){var l=Lo(t);Ie(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");var c=wo++;e.queryToTagMap.set(l,c),e.tagToQueryMap.set(c,l)}var h=ho(s,t,n,xi(e.pendingWriteTree_,r),i,a);if(!u&&!o){var p=vo(s,t);h=h.concat(function(e,t,n){var r=t._path,i=Do(e,t),o=Oo(e,n),a=e.listenProvider_.startListening(jo(t),i,o.hashFn,o.onComplete),s=e.syncPointTree_.subtree(r);if(i)Ie(!go(s.value),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold((function(e,t,n){if(!Bn(e)&&t&&go(t))return[mo(t).query];var r=[];return t&&(r=r.concat(fo(t).map((function(e){return e.query})))),sn(n,(function(e,t){r=r.concat(t)})),r})),l=0;l<u.length;++l){var c=u[l];e.listenProvider_.stopListening(jo(c),Do(e,c))}return a}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,p))}return h}function Po(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=_o(n,zn(e,t));if(r)return r}));return Li(r,t,i,n,!0)}function No(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var i=zn(e,n);r=r||_o(t,i)}));var i=e.syncPointTree_.get(n);i?r=r||_o(i,Dn()):(i=new uo,e.syncPointTree_=e.syncPointTree_.set(n,i));var o=null!=r,a=o?new ci(r,!0,!1):null;return function(e){return vi(e.viewCache_)}(co(i,t,xi(e.pendingWriteTree_,t._path),o?a.getNode():Tr.EMPTY_NODE,o))}function xo(e,t){return Ro(t,e.syncPointTree_,null,xi(e.pendingWriteTree_,Dn()))}function Ro(e,t,n,r){if(Bn(e.path))return Ao(e,t,n,r);var i=t.get(Dn());null==n&&null!=i&&(n=_o(i,Dn()));var o=[],a=Ln(e.path),s=e.operationForChild(a),u=t.children.get(a);if(u&&s){var l=n?n.getImmediateChild(a):null,c=Bi(r,a);o=o.concat(Ro(s,u,l,c))}return i&&(o=o.concat(lo(i,e,r,n))),o}function Ao(e,t,n,r){var i=t.get(Dn());null==n&&null!=i&&(n=_o(i,Dn()));var o=[];return t.children.inorderTraversal((function(t,i){var a=n?n.getImmediateChild(t):null,s=Bi(r,t),u=e.operationForChild(t);u&&(o=o.concat(Ao(u,i,a,s)))})),i&&(o=o.concat(lo(i,e,r,n))),o}function Oo(e,t){var n=t.query,r=Do(e,n);return{hashFn:function(){return(function(e){return e.viewCache_.serverCache.getNode()}(t)||Tr.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=Fo(e,n);if(r){var i=Mo(r),o=i.path,a=i.queryId,s=zn(o,t);return qo(e,o,new si(ii(a),s))}return[]}(e,n._path,r):function(e,t){return xo(e,new si({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return So(e,n,null,i)}}}function Do(e,t){var n=Lo(t);return e.queryToTagMap.get(n)}function Lo(e){return e._path.toString()+"$"+e._queryIdentifier}function Fo(e,t){return e.tagToQueryMap.get(t)}function Mo(e){var t=e.indexOf("$");return Ie(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new On(e.substr(0,t))}}function qo(e,t,n){var r=e.syncPointTree_.get(t);return Ie(r,"Missing sync point for query tag that we're tracking"),lo(r,n,xi(e.pendingWriteTree_,t),null)}function jo(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Ie(so,"Reference.ts has not been loaded"),so)(e._repo,e._path):e}var Wo=function(){function e(e){this.node_=e}return e.prototype.getImmediateChild=function(t){return new e(this.node_.getImmediateChild(t))},e.prototype.node=function(){return this.node_},e}(),Uo=function(){function e(e,t){this.syncTree_=e,this.path_=t}return e.prototype.getImmediateChild=function(t){var n=Un(this.path_,t);return new e(this.syncTree_,n)},e.prototype.node=function(){return Po(this.syncTree_,this.path_)},e}(),Bo=function(e,t,n){return e&&"object"==typeof e?(Ie(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?zo(e[".sv"],t,n):"object"==typeof e[".sv"]?Vo(e[".sv"],t):void Ie(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},zo=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:Ie(!1,"Unexpected server value: "+e)}},Vo=function(e,t,n){e.hasOwnProperty("increment")||Ie(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&Ie(!1,"Unexpected increment value: "+r);var i=t.node();if(Ie(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var o=i.getValue();return"number"!=typeof o?r:o+r},Ho=function(e,t,n,r){return Qo(t,new Uo(n,e),r)},$o=function(e,t,n){return Qo(e,new Wo(t),n)};function Qo(e,t,n){var r,i=e.getPriority().val(),o=Bo(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var a=e,s=Bo(a.getValue(),t,n);return s!==a.getValue()||o!==a.getPriority().val()?new _r(s,Sr(o)):e}var u=e;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new _r(o))),u.forEachChild(gr,(function(e,i){var o=Qo(i,t.getImmediateChild(e),n);o!==i&&(r=r.updateImmediateChild(e,o))})),r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yo=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n={children:{},childCount:0}),this.name=e,this.parent=t,this.node=n};function Ko(e,t){for(var n=t instanceof On?t:new On(t),r=e,i=Ln(n);null!==i;){var o=Ve(r.node.children,i)||{children:{},childCount:0};r=new Yo(i,r,o),i=Ln(n=Mn(n))}return r}function Go(e){return e.node.value}function Jo(e,t){e.node.value=t,na(e)}function Xo(e){return e.node.childCount>0}function Zo(e,t){sn(e.node.children,(function(n,r){t(new Yo(n,e,r))}))}function ea(e,t,n,r){n&&!r&&t(e),Zo(e,(function(e){ea(e,t,!0,r)})),n&&r&&t(e)}function ta(e){return new On(null===e.parent?e.name:ta(e.parent)+"/"+e.name)}function na(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===Go(e)&&!Xo(e)}(n),i=ze(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,na(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,na(e))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e.parent,e.name,e)}var ra=/[\[\].#$\/\u0000-\u001F\u007F]/,ia=/[\[\].#$\u0000-\u001F\u007F]/,oa=function(e){return"string"==typeof e&&0!==e.length&&!ra.test(e)},aa=function(e){return"string"==typeof e&&0!==e.length&&!ia.test(e)},sa=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!Xt(e)||e&&"object"==typeof e&&ze(e,".sv")},ua=function(e,t,n,r){r&&void 0===t||la(Xe(e,"value"),t,n)},la=function(e,t,n){var r=n instanceof On?new Qn(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Kn(r));if("function"==typeof t)throw new Error(e+"contains a function "+Kn(r)+" with contents = "+t.toString());if(Xt(t))throw new Error(e+"contains "+t.toString()+" "+Kn(r));if("string"==typeof t&&t.length>10485760/3&&tt(t)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+Kn(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,o=!1;if(sn(t,(function(t,n){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!oa(t)))throw new Error(e+" contains an invalid key ("+t+") "+Kn(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var a,s;s=t,(a=r).parts_.length>0&&(a.byteLength_+=1),a.parts_.push(s),a.byteLength_+=tt(s),Yn(a),la(e,n,r),function(e){var t=e.parts_.pop();e.byteLength_-=tt(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),i&&o)throw new Error(e+' contains ".value" child '+Kn(r)+" in addition to actual children.")}},ca=function(e,t,n,r){if(!r||void 0!==t){var i=Xe(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var o=[];sn(t,(function(e,t){var r=new On(e);if(la(i,t,Un(n,r)),".priority"===qn(r)&&!sa(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(r)})),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=jn(r=t[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!oa(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(Vn);var a=null;for(n=0;n<t.length;n++){if(r=t[n],null!==a&&$n(a,r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,o)}},ha=function(e,t,n){if(!n||void 0!==t){if(Xt(t))throw new Error(Xe(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!sa(t))throw new Error(Xe(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},pa=function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Xe(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},da=function(e,t,n,r){if(!(r&&void 0===n||oa(n)))throw new Error(Xe(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},fa=function(e,t,n,r){if(!(r&&void 0===n||aa(n)))throw new Error(Xe(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},_a=function(e,t){if(".info"===Ln(t))throw new Error(e+" failed = Can't modify data under /.info/")},va=function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!oa(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),aa(e)}(n))throw new Error(Xe(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},ya=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Xe(e,t)+"must be a boolean.")},ga=function(){this.eventLists_=[],this.recursionDepth_=0};function ma(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],o=i.getPath();null===n||Hn(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function wa(e,t,n){ma(e,n),Ca(e,(function(e){return Hn(e,t)}))}function ba(e,t,n){ma(e,n),Ca(e,(function(e){return $n(e,t)||$n(t,e)}))}function Ca(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(Ea(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function Ea(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();Vt&&Qt("event: "+n.toString()),hn(r)}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ta=function(){function e(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ga,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Gr(),this.transactionQueueTree_=new Yo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e}();function Ia(e,t,n){if(e.stats_=Cn(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Yr(e.repoInfo_,(function(t,n,r,i){Pa(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return Na(e,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ue(n)}catch(a){throw new Error("Invalid authOverride provided: "+a)}}e.persistentConnection_=new Zn(e.repoInfo_,t,(function(t,n,r,i){Pa(e,t,n,r,i)}),(function(t){Na(e,t)}),(function(t){!function(e,t){sn(t,(function(t,n){xa(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}var r,i,o;e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=(r=e.repoInfo_,i=function(){return new ri(e.stats_,e.server_)},o=r.toString(),bn[o]||(bn[o]=i()),bn[o]),e.infoData_=new Kr,e.infoSyncTree_=new bo({startListening:function(t,n,r,i){var o=[],a=e.infoData_.getNode(t._path);return a.isEmpty()||(o=Io(e.infoSyncTree_,t._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),xa(e,"connected",!1),e.serverSyncTree_=new bo({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var o=i(n,r);ba(e.eventQueue_,t._path,o)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function Sa(e){var t=e.infoData_.getNode(new On(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function ka(e){return(t=(t={timestamp:Sa(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Pa(e,t,n,r,i){e.dataUpdateCount++;var o=new On(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var a=[];if(i)if(r){var s=$e(n,(function(e){return Sr(e)}));a=function(e,t,n,r){var i=Fo(e,r);if(i){var o=Mo(i),a=o.path,s=o.queryId,u=zn(a,t),l=gi.fromObject(n);return qo(e,a,new li(ii(s),u,l))}return[]}(e.serverSyncTree_,o,s,i)}else{var u=Sr(n);a=function(e,t,n,r){var i=Fo(e,r);if(null!=i){var o=Mo(i),a=o.path,s=o.queryId,u=zn(a,t);return qo(e,a,new ui(ii(s),u,n))}return[]}(e.serverSyncTree_,o,u,i)}else if(r){var l=$e(n,(function(e){return Sr(e)}));a=function(e,t,n){var r=gi.fromObject(n);return xo(e,new li({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,o,l)}else{var c=Sr(n);a=Io(e.serverSyncTree_,o,c)}var h=o;a.length>0&&(h=Ua(e,o)),ba(e.eventQueue_,h,a)}function Na(e,t){xa(e,"connected",t),!1===t&&function(e){Ma(e,"onDisconnectEvents");var t=ka(e),n=Gr();Zr(e.onDisconnect_,Dn(),(function(r,i){var o=Ho(r,i,e.serverSyncTree_,t);Jr(n,r,o)}));var r=[];Zr(n,Dn(),(function(t,n){r=r.concat(Io(e.serverSyncTree_,t,n));var i=$a(e,t);Ua(e,i)})),e.onDisconnect_=Gr(),ba(e.eventQueue_,Dn(),r)}(e)}function xa(e,t,n){var r=new On("/.info/"+t),i=Sr(n);e.infoData_.updateSnapshot(r,i);var o=Io(e.infoSyncTree_,r,i);ba(e.eventQueue_,r,o)}function Ra(e){return e.nextWriteId_++}function Aa(e,t,n,r,i){Ma(e,"set",{path:t.toString(),value:n,priority:r});var o=ka(e),a=Sr(n,r),s=Po(e.serverSyncTree_,t),u=$o(a,s,o),l=Ra(e),c=Co(e.serverSyncTree_,t,u,l,!0);ma(e.eventQueue_,c),e.server_.put(t.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||Jt("set at "+t+" failed: "+n);var a=To(e.serverSyncTree_,l,!o);ba(e.eventQueue_,t,a),qa(e,i,n,r)}));var h=$a(e,t);Ua(e,h),ba(e.eventQueue_,h,[])}function Oa(e,t,n){e.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&Xr(e.onDisconnect_,t),qa(e,n,r,i)}))}function Da(e,t,n,r){var i=Sr(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(function(n,o){"ok"===n&&Jr(e.onDisconnect_,t,i),qa(e,r,n,o)}))}function La(e,t,n){var r;r=".info"===Ln(t._path)?So(e.infoSyncTree_,t,n):So(e.serverSyncTree_,t,n),wa(e.eventQueue_,t._path,r)}function Fa(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}function Ma(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),Qt.apply(void 0,Ce([r],be(t)))}function qa(e,t,n,r){t&&hn((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var o=new Error(i);o.code=e,t(o)}}))}function ja(e,t,n){return Po(e.serverSyncTree_,t,n)||Tr.EMPTY_NODE}function Wa(e,t){if(void 0===t&&(t=e.transactionQueueTree_),t||Ha(e,t),Go(t)){var n=za(e,t);Ie(n.length>0,"Sending zero length transaction queue"),n.every((function(e){return 0===e.status}))&&function(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=ja(e,t,r),o=i,a=i.hash(),s=0;s<n.length;s++){var u=n[s];Ie(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var l=zn(t,u.path);o=o.updateChild(l,u.currentOutputSnapshotRaw)}var c=o.val(!0),h=t;e.server_.put(h.toString(),c,(function(r){Ma(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(t){n[t].status=2,i=i.concat(To(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&o.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},s=0;s<n.length;s++)a(s);Ha(e,Ko(e.transactionQueueTree_,t)),Wa(e,e.transactionQueueTree_),ba(e.eventQueue_,t,i);for(s=0;s<o.length;s++)hn(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else{Jt("transaction at "+h.toString()+" failed: "+r);for(s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r}Ua(e,t)}}),a)}(e,ta(t),n)}else Xo(t)&&Zo(t,(function(t){Wa(e,t)}))}function Ua(e,t){var n=Ba(e,t),r=ta(n);return function(e,t,n){if(0===t.length)return;for(var r=[],i=[],o=t.filter((function(e){return 0===e.status})).map((function(e){return e.currentWriteId})),a=function(a){var s,u,l=t[a],c=zn(n,l.path),h=!1;if(Ie(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)h=!0,s=l.abortReason,i=i.concat(To(e.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)h=!0,s="maxretry",i=i.concat(To(e.serverSyncTree_,l.currentWriteId,!0));else{var p=ja(e,l.path,o);l.currentInputSnapshot=p;var d=t[a].update(p.val());if(void 0!==d){la("transaction failed: Data returned ",d,l.path);var f=Sr(d);"object"==typeof d&&null!=d&&ze(d,".priority")||(f=f.updatePriority(p.getPriority()));var _=l.currentWriteId,v=ka(e),y=$o(f,p,v);l.currentOutputSnapshotRaw=f,l.currentOutputSnapshotResolved=y,l.currentWriteId=Ra(e),o.splice(o.indexOf(_),1),i=(i=i.concat(Co(e.serverSyncTree_,l.path,y,l.currentWriteId,l.applyLocally))).concat(To(e.serverSyncTree_,_,!0))}else h=!0,s="nodata",i=i.concat(To(e.serverSyncTree_,l.currentWriteId,!0))}ba(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,u=t[a].unwatcher,setTimeout(u,Math.floor(0)),t[a].onComplete&&("nodata"===s?r.push((function(){return t[a].onComplete(null,!1,t[a].currentInputSnapshot)})):r.push((function(){return t[a].onComplete(new Error(s),!1,null)}))))},s=0;s<t.length;s++)a(s);Ha(e,e.transactionQueueTree_);for(s=0;s<r.length;s++)hn(r[s]);Wa(e,e.transactionQueueTree_)}(e,za(e,n),r),r}function Ba(e,t){var n,r=e.transactionQueueTree_;for(n=Ln(t);null!==n&&void 0===Go(r);)r=Ko(r,n),n=Ln(t=Mn(t));return r}function za(e,t){var n=[];return Va(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function Va(e,t,n){var r=Go(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Zo(t,(function(t){Va(e,t,n)}))}function Ha(e,t){var n=Go(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Jo(t,n.length>0?n:void 0)}Zo(t,(function(t){Ha(e,t)}))}function $a(e,t){var n=ta(Ba(e,t)),r=Ko(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){Qa(e,t)})),Qa(e,r),ea(r,(function(t){Qa(e,t)})),n}function Qa(e,t){var n=Go(t);if(n){for(var r=[],i=[],o=-1,a=0;a<n.length;a++)3===n[a].status||(1===n[a].status?(Ie(o===a-1,"All SENT items should be at beginning of queue."),o=a,n[a].status=3,n[a].abortReason="set"):(Ie(0===n[a].status,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat(To(e.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&r.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Jo(t,void 0):n.length=o+1,ba(e.eventQueue_,ta(t),i);for(a=0;a<r.length;a++)hn(r[a])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ya=function(e,t){var n=Ka(e),r=n.namespace;"firebase.com"===n.domain&&Gt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Gt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Jt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new yn(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new On(n.pathString)}},Ka=function(e){var t="",n="",r="",i="",o="",a=!0,s="https",u=443;if("string"==typeof e){var l=e.indexOf("//");l>=0&&(s=e.substring(0,l-1),e=e.substring(l+2));var c=e.indexOf("/");-1===c&&(c=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(c,h)),c<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}t+="/"+i}return t}(e.substring(c,h)));var p=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=we(e.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var s=a.split("=");2===s.length?r[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Jt("Invalid query segment '"+a+"' in query '"+e+"'")}}}catch(u){t={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,h)));(l=t.indexOf(":"))>=0?(a="https"===s||"wss"===s,u=parseInt(t.substring(l+1),10)):l=t.length;var d=t.slice(0,l);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var f=t.indexOf(".");r=t.substring(0,f).toLowerCase(),n=t.substring(f+1),o=r}"ns"in p&&(o=p.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:a,scheme:s,pathString:i,namespace:o}},Ga=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Ue(this.snapshot.exportVal())},e}(),Ja=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),Xa=function(){function e(e,t){this.snapshotCallback=e,this.cancelCallback=t}return e.prototype.onValue=function(e,t){this.snapshotCallback.call(null,e,t)},e.prototype.onCancel=function(e){return Ie(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)},Object.defineProperty(e.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),e.prototype.matches=function(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context},e}(),Za=function(){function e(e,t){this._repo=e,this._path=t}return e.prototype.cancel=function(){var e=new Ae;return Oa(this._repo,this._path,e.wrapCallback((function(){}))),e.promise},e.prototype.remove=function(){_a("OnDisconnect.remove",this._path);var e=new Ae;return Da(this._repo,this._path,null,e.wrapCallback((function(){}))),e.promise},e.prototype.set=function(e){_a("OnDisconnect.set",this._path),ua("OnDisconnect.set",e,this._path,!1);var t=new Ae;return Da(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise},e.prototype.setWithPriority=function(e,t){_a("OnDisconnect.setWithPriority",this._path),ua("OnDisconnect.setWithPriority",e,this._path,!1),ha("OnDisconnect.setWithPriority",t,!1);var n=new Ae;return function(e,t,n,r,i){var o=Sr(n,r);e.server_.onDisconnectPut(t.toString(),o.val(!0),(function(n,r){"ok"===n&&Jr(e.onDisconnect_,t,o),qa(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((function(){}))),n.promise},e.prototype.update=function(e){_a("OnDisconnect.update",this._path),ca("OnDisconnect.update",e,this._path,!1);var t=new Ae;return function(e,t,n,r){if(He(n))return Qt("onDisconnect().update() called with empty data.  Don't do anything."),void qa(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(function(i,o){"ok"===i&&sn(n,(function(n,r){var i=Sr(r);Jr(e.onDisconnect_,Un(t,n),i)})),qa(0,r,i,o)}))}(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise},e}(),es=function(){function e(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(e.prototype,"key",{get:function(){return Bn(this._path)?null:qn(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new is(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryIdentifier",{get:function(){var e=Qr(this._queryParams),t=on(e);return"{}"===t?"default":t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryObject",{get:function(){return Qr(this._queryParams)},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(!((t=nt(t))instanceof e))return!1;var n=this._repo===t._repo,r=Hn(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i},e.prototype.toJSON=function(){return this.toString()},e.prototype.toString=function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)},e}();function ts(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function ns(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===rr){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==Zt)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==en)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===gr){if(null!=t&&!sa(t)||null!=n&&!sa(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Ie(e.getIndex()instanceof Nr||e.getIndex()===xr,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function rs(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var is=function(e){function t(t,n){return e.call(this,t,n,new Br,!1)||this}return ve(t,e),Object.defineProperty(t.prototype,"parent",{get:function(){var e=Wn(this._path);return null===e?null:new t(this._repo,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e},enumerable:!1,configurable:!0}),t}(es),os=function(){function e(e,t,n){this._node=e,this.ref=t,this._index=n}return Object.defineProperty(e.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),e.prototype.child=function(t){var n=new On(t),r=us(this.ref,t);return new e(this._node.getChild(n),r,gr)},e.prototype.exists=function(){return!this._node.isEmpty()},e.prototype.exportVal=function(){return this._node.val(!0)},e.prototype.forEach=function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return t(new e(i,us(n.ref,r),gr))}))},e.prototype.hasChild=function(e){var t=new On(e);return!this._node.getChild(t).isEmpty()},e.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},e.prototype.toJSON=function(){return this.exportVal()},e.prototype.val=function(){return this._node.val()},e}();function as(e,t){return(e=nt(e))._checkNotDeleted("ref"),void 0!==t?us(e._root,t):e._root}function ss(e,t){(e=nt(e))._checkNotDeleted("refFromURL");var n=Ya(t,e._repo.repoInfo_.nodeAdmin);va("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||Gt("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),as(e,n.path.toString())}function us(e,t){var n,r,i,o;return null===Ln((e=nt(e))._path)?(n="child",r="path",o=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),fa(n,r,i,o)):fa("child","path",t,!1),new is(e._repo,Un(e._path,t))}function ls(e,t){e=nt(e),_a("push",e._path),ua("push",t,e._path,!0);var n,r=Sa(e._repo),i=Ar(r),o=us(e,i),a=us(e,i);return n=null!=t?hs(a,t).then((function(){return a})):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),o}function cs(e){return _a("remove",e._path),hs(e,null)}function hs(e,t){e=nt(e),_a("set",e._path),ua("set",t,e._path,!1);var n=new Ae;return Aa(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function ps(e,t){e=nt(e),_a("setPriority",e._path),ha("setPriority",t,!1);var n=new Ae;return Aa(e._repo,Un(e._path,".priority"),t,null,n.wrapCallback((function(){}))),n.promise}function ds(e,t,n){if(_a("setWithPriority",e._path),ua("setWithPriority",t,e._path,!1),ha("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new Ae;return Aa(e._repo,e._path,t,n,r.wrapCallback((function(){}))),r.promise}function fs(e,t){ca("update",t,e._path,!1);var n=new Ae;return function(e,t,n,r){Ma(e,"update",{path:t.toString(),value:n});var i=!0,o=ka(e),a={};if(sn(n,(function(n,r){i=!1,a[n]=Ho(Un(t,n),Sr(r),e.serverSyncTree_,o)})),i)Qt("update() called with empty data.  Don't do anything."),qa(0,r,"ok",void 0);else{var s=Ra(e),u=Eo(e.serverSyncTree_,t,a,s);ma(e.eventQueue_,u),e.server_.merge(t.toString(),n,(function(n,i){var o="ok"===n;o||Jt("update at "+t+" failed: "+n);var a=To(e.serverSyncTree_,s,!o),u=a.length>0?Ua(e,t):t;ba(e.eventQueue_,u,a),qa(0,r,n,i)})),sn(n,(function(n){var r=$a(e,Un(t,n));Ua(e,r)})),ba(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((function(){}))),n.promise}function _s(e){return function(e,t){var n=No(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((function(n){var r=Sr(n).withIndex(t._queryParams.getIndex()),i=Io(e.serverSyncTree_,t._path,r);return wa(e.eventQueue_,t._path,i),Promise.resolve(r)}),(function(n){return Ma(e,"get for query "+Ue(t)+" failed: "+n),Promise.reject(new Error(n))}))}((e=nt(e))._repo,e).then((function(t){return new os(t,new is(e._repo,e._path),e._queryParams.getIndex())}))}var vs=function(){function e(e){this.callbackContext=e}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t._queryParams.getIndex();return new Ga("value",this,new os(e.snapshotNode,new is(t._repo,t._path),n))},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new Ja(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))},e.prototype.hasAnyCallback=function(){return null!==this.callbackContext},e}(),ys=function(){function e(e,t){this.eventType=e,this.callbackContext=t}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new Ja(this,e,t):null},e.prototype.createEvent=function(e,t){Ie(null!=e.childName,"Child events should have a childName.");var n=us(new is(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Ga(e.type,this,new os(e.snapshotNode,n,r),e.prevName)},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}},e.prototype.matches=function(t){return t instanceof e&&(this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)))},e.prototype.hasAnyCallback=function(){return!!this.callbackContext},e}();function gs(e,t,n,r,i){var o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(t,n){La(e._repo,e,l),a(t,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new Xa(n,o||void 0),l="value"===t?new vs(u):new ys(t,u);return function(e,t,n){var r;r=".info"===Ln(t._path)?ko(e.infoSyncTree_,t,n):ko(e.serverSyncTree_,t,n),wa(e.eventQueue_,t._path,r)}(e._repo,e,l),function(){return La(e._repo,e,l)}}function ms(e,t,n,r){return gs(e,"value",t,n,r)}function ws(e,t,n,r){return gs(e,"child_added",t,n,r)}function bs(e,t,n,r){return gs(e,"child_changed",t,n,r)}function Cs(e,t,n,r){return gs(e,"child_moved",t,n,r)}function Es(e,t,n,r){return gs(e,"child_removed",t,n,r)}function Ts(e,t,n){var r=null,i=n?new Xa(n):null;"value"===t?r=new vs(i):t&&(r=new ys(t,i)),La(e._repo,e,r)}var Is=function(){},Ss=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ve(t,e),t.prototype._apply=function(e){ua("endAt",this._value,e._path,!0);var t=Vr(e._queryParams,this._value,this._key);if(rs(t),ns(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new es(e._repo,e._path,t,e._orderByCalled)},t}(Is);function ks(e,t){return da("endAt","key",t,!0),new Ss(e,t)}var Ps=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ve(t,e),t.prototype._apply=function(e){ua("endBefore",this._value,e._path,!1);var t,n,r,i,o=(t=e._queryParams,n=this._value,r=this._key,t.index_===rr?("string"==typeof n&&(n=Dr(n)),i=Vr(t,n,r)):i=Vr(t,n,null==r?Zt:Dr(r)),i.endBeforeSet_=!0,i);if(rs(o),ns(o),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new es(e._repo,e._path,o,e._orderByCalled)},t}(Is);function Ns(e,t){return da("endBefore","key",t,!0),new Ps(e,t)}var xs=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ve(t,e),t.prototype._apply=function(e){ua("startAt",this._value,e._path,!0);var t=zr(e._queryParams,this._value,this._key);if(rs(t),ns(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new es(e._repo,e._path,t,e._orderByCalled)},t}(Is);function Rs(e,t){return void 0===e&&(e=null),da("startAt","key",t,!0),new xs(e,t)}var As=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ve(t,e),t.prototype._apply=function(e){ua("startAfter",this._value,e._path,!1);var t=function(e,t,n){var r;e.index_===rr?("string"==typeof t&&(t=Or(t)),r=zr(e,t,n)):r=zr(e,t,null==n?en:Or(n));return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(rs(t),ns(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new es(e._repo,e._path,t,e._orderByCalled)},t}(Is);function Os(e,t){return da("startAfter","key",t,!0),new As(e,t)}var Ds=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return ve(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new es(e._repo,e._path,(t=e._queryParams,n=this._limit,(r=t.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="l",r),e._orderByCalled);var t,n,r},t}(Is);function Ls(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Ds(e)}var Fs=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return ve(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new es(e._repo,e._path,(t=e._queryParams,n=this._limit,(r=t.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="r",r),e._orderByCalled);var t,n,r},t}(Is);function Ms(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Fs(e)}var qs=function(e){function t(t){var n=e.call(this)||this;return n._path=t,n}return ve(t,e),t.prototype._apply=function(e){ts(e,"orderByChild");var t=new On(this._path);if(Bn(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new Nr(t),r=Hr(e._queryParams,n);return ns(r),new es(e._repo,e._path,r,!0)},t}(Is);function js(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return fa("orderByChild","path",e,!1),new qs(e)}var Ws=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ve(t,e),t.prototype._apply=function(e){ts(e,"orderByKey");var t=Hr(e._queryParams,rr);return ns(t),new es(e._repo,e._path,t,!0)},t}(Is);function Us(){return new Ws}var Bs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ve(t,e),t.prototype._apply=function(e){ts(e,"orderByPriority");var t=Hr(e._queryParams,gr);return ns(t),new es(e._repo,e._path,t,!0)},t}(Is);function zs(){return new Bs}var Vs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ve(t,e),t.prototype._apply=function(e){ts(e,"orderByValue");var t=Hr(e._queryParams,xr);return ns(t),new es(e._repo,e._path,t,!0)},t}(Is);function Hs(){return new Vs}var $s=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return ve(t,e),t.prototype._apply=function(e){if(ua("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Ss(this._value,this._key)._apply(new xs(this._value,this._key)._apply(e))},t}(Is);function Qs(e,t){return da("equalTo","key",t,!0),new $s(e,t)}function Ys(e){for(var t,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=nt(e);try{for(var a=we(r),s=a.next();!s.done;s=a.next()){var u=s.value;o=u._apply(o)}}catch(l){t={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}!function(e){Ie(!eo,"__referenceConstructor has already been defined"),eo=e}(is),function(e){Ie(!so,"__referenceConstructor has already been defined"),so=e}(is);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ks={},Gs=!1;function Js(e,t,n,r,i){var o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||Gt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Qt("Using default host for project ",e.options.projectId),o=e.options.projectId+"-default-rtdb.firebaseio.com");var a,s=Ya(o,i),u=s.repoInfo,l=void 0;"undefined"!=typeof process&&(l=process.env.FIREBASE_DATABASE_EMULATOR_HOST),l?(a=!0,o="http://"+l+"?ns="+u.namespace,u=(s=Ya(o,i)).repoInfo):a=!s.repoInfo.secure;var c=i&&a?new _n(_n.OWNER):new fn(e.name,e.options,t);va("Invalid Firebase Database URL",s),Bn(s.path)||Gt("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=Ks[t.name];i||(i={},Ks[t.name]=i);var o=i[e.toURLString()];o&&Gt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new Ta(e,Gs,n,r),i[e.toURLString()]=o,o}(u,e,c,new dn(e.name,n));return new Xs(h,e)}var Xs=function(){function e(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}return Object.defineProperty(e.prototype,"_repo",{get:function(){return this._instanceStarted||(Ia(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new is(this._repo,Dn())),this._rootInternal},enumerable:!1,configurable:!0}),e.prototype._delete=function(){var e,t,n;return null!==this._rootInternal&&(e=this._repo,t=this.app.name,(n=Ks[t])&&n[e.key]===e||Gt("Database "+t+"("+e.repoInfo_+") has already been deleted."),Fa(e),delete n[e.key],this._repoInternal=null,this._rootInternal=null),Promise.resolve()},e.prototype._checkNotDeleted=function(e){null===this._rootInternal&&Gt("Cannot call "+e+" on a deleted database.")},e}();function Zs(e,t,n,r){void 0===r&&(r={}),(e=nt(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Gt("Cannot call useEmulator() after instance has already been initialized.");var i=e._repoInternal,o=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Gt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new _n(_n.OWNER);else if(r.mockUserToken){var a=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=ye({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Pe.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),Pe.encodeString(JSON.stringify(o),!1),""].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(r.mockUserToken,e.app.options.projectId);o=new _n(a)}!function(e,t,n,r){e.repoInfo_=new yn(t+":"+n,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(i,t,n,o)}function eu(e){(e=nt(e))._checkNotDeleted("goOffline"),Fa(e._repo)}function tu(e){var t;(e=nt(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume("repo_interrupt")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nu={".sv":"timestamp"};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ru=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}();function iu(e,t,n){var r;if(e=nt(e),_a("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,o=new Ae,a=ms(e,(function(){}));return function(e,t,n,r,i,o){Ma(e,"transaction on "+t);var a={path:t,update:n,onComplete:r,status:null,order:Ut(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=ja(e,t,void 0);a.currentInputSnapshot=s;var u=a.update(s.val());if(void 0===u)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{la("transaction failed: Data returned ",u,a.path),a.status=0;var l=Ko(e.transactionQueueTree_,t),c=Go(l)||[];c.push(a),Jo(l,c);var h=void 0;"object"==typeof u&&null!==u&&ze(u,".priority")?(h=Ve(u,".priority"),Ie(sa(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Po(e.serverSyncTree_,t)||Tr.EMPTY_NODE).getPriority().val();var p=ka(e),d=Sr(u,h),f=$o(d,s,p);a.currentOutputSnapshotRaw=d,a.currentOutputSnapshotResolved=f,a.currentWriteId=Ra(e);var _=Co(e.serverSyncTree_,t,f,a.currentWriteId,a.applyLocally);ba(e.eventQueue_,t,_),Wa(e,e.transactionQueueTree_)}}(e._repo,e._path,t,(function(t,n,r){var i=null;t?o.reject(t):(i=new os(r,new is(e._repo,e._path),gr),o.resolve(new ru(n,i)))}),a,i),o.promise}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ou=function(){function e(e){this._delegate=e}return e.prototype.cancel=function(e){Je("OnDisconnect.cancel",0,1,arguments.length),Ze("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},e.prototype.remove=function(e){Je("OnDisconnect.remove",0,1,arguments.length),Ze("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},e.prototype.set=function(e,t){Je("OnDisconnect.set",1,2,arguments.length),Ze("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},e.prototype.setWithPriority=function(e,t,n){Je("OnDisconnect.setWithPriority",2,3,arguments.length),Ze("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r},e.prototype.update=function(e,t){if(Je("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Jt("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ze("OnDisconnect.update","onComplete",t,!0);var i=this._delegate.update(e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i},e}(),au=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return Je("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),su=function(){function e(e,t){this._database=e,this._delegate=t}return e.prototype.val=function(){return Je("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},e.prototype.exportVal=function(){return Je("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},e.prototype.toJSON=function(){return Je("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.exists=function(){return Je("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},e.prototype.child=function(t){return Je("DataSnapshot.child",0,1,arguments.length),t=String(t),fa("DataSnapshot.child","path",t,!1),new e(this._database,this._delegate.child(t))},e.prototype.hasChild=function(e){return Je("DataSnapshot.hasChild",1,1,arguments.length),fa("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)},e.prototype.getPriority=function(){return Je("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},e.prototype.forEach=function(t){var n=this;return Je("DataSnapshot.forEach",1,1,arguments.length),Ze("DataSnapshot.forEach","action",t,!1),this._delegate.forEach((function(r){return t(new e(n._database,r))}))},e.prototype.hasChildren=function(){return Je("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(e.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),e.prototype.numChildren=function(){return Je("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},e.prototype.getRef=function(){return Je("DataSnapshot.ref",0,0,arguments.length),new lu(this._database,this._delegate.ref)},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),uu=function(){function e(e,t){this.database=e,this._delegate=t}return e.prototype.on=function(t,n,r,i){var o,a=this;Je("Query.on",2,4,arguments.length),Ze("Query.on","callback",n,!1);var s=e.getCancelAndContextArgs_("Query.on",r,i),u=function(e,t){n.call(s.context,new su(a.database,e),t)};u.userCallback=n,u.context=s.context;var l=null===(o=s.cancel)||void 0===o?void 0:o.bind(s.context);switch(t){case"value":return ms(this._delegate,u,l),n;case"child_added":return ws(this._delegate,u,l),n;case"child_removed":return Es(this._delegate,u,l),n;case"child_changed":return bs(this._delegate,u,l),n;case"child_moved":return Cs(this._delegate,u,l),n;default:throw new Error(Xe("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},e.prototype.off=function(e,t,n){if(Je("Query.off",0,3,arguments.length),pa("Query.off",e,!0),Ze("Query.off","callback",t,!0),et("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,Ts(this._delegate,e,r)}else Ts(this._delegate,e)},e.prototype.get=function(){var e=this;return _s(this._delegate).then((function(t){return new su(e.database,t)}))},e.prototype.once=function(t,n,r,i){var o=this;Je("Query.once",1,4,arguments.length),Ze("Query.once","callback",n,!0);var a=e.getCancelAndContextArgs_("Query.once",r,i),s=new Ae,u=function(e,t){var r=new su(o.database,e);n&&n.call(a.context,r,t),s.resolve(r)};u.userCallback=n,u.context=a.context;var l=function(e){a.cancel&&a.cancel.call(a.context,e),s.reject(e)};switch(t){case"value":ms(this._delegate,u,l,{onlyOnce:!0});break;case"child_added":ws(this._delegate,u,l,{onlyOnce:!0});break;case"child_removed":Es(this._delegate,u,l,{onlyOnce:!0});break;case"child_changed":bs(this._delegate,u,l,{onlyOnce:!0});break;case"child_moved":Cs(this._delegate,u,l,{onlyOnce:!0});break;default:throw new Error(Xe("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise},e.prototype.limitToFirst=function(t){return Je("Query.limitToFirst",1,1,arguments.length),new e(this.database,Ys(this._delegate,Ls(t)))},e.prototype.limitToLast=function(t){return Je("Query.limitToLast",1,1,arguments.length),new e(this.database,Ys(this._delegate,Ms(t)))},e.prototype.orderByChild=function(t){return Je("Query.orderByChild",1,1,arguments.length),new e(this.database,Ys(this._delegate,js(t)))},e.prototype.orderByKey=function(){return Je("Query.orderByKey",0,0,arguments.length),new e(this.database,Ys(this._delegate,Us()))},e.prototype.orderByPriority=function(){return Je("Query.orderByPriority",0,0,arguments.length),new e(this.database,Ys(this._delegate,zs()))},e.prototype.orderByValue=function(){return Je("Query.orderByValue",0,0,arguments.length),new e(this.database,Ys(this._delegate,Hs()))},e.prototype.startAt=function(t,n){return void 0===t&&(t=null),Je("Query.startAt",0,2,arguments.length),new e(this.database,Ys(this._delegate,Rs(t,n)))},e.prototype.startAfter=function(t,n){return void 0===t&&(t=null),Je("Query.startAfter",0,2,arguments.length),new e(this.database,Ys(this._delegate,Os(t,n)))},e.prototype.endAt=function(t,n){return void 0===t&&(t=null),Je("Query.endAt",0,2,arguments.length),new e(this.database,Ys(this._delegate,ks(t,n)))},e.prototype.endBefore=function(t,n){return void 0===t&&(t=null),Je("Query.endBefore",0,2,arguments.length),new e(this.database,Ys(this._delegate,Ns(t,n)))},e.prototype.equalTo=function(t,n){return Je("Query.equalTo",1,2,arguments.length),new e(this.database,Ys(this._delegate,Qs(t,n)))},e.prototype.toString=function(){return Je("Query.toString",0,0,arguments.length),this._delegate.toString()},e.prototype.toJSON=function(){return Je("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.isEqual=function(t){if(Je("Query.isEqual",1,1,arguments.length),!(t instanceof e)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(t._delegate)},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Ze(e,"cancel",r.cancel,!0),r.context=n,et(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(Xe(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return new lu(this.database,new is(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),e}(),lu=function(e){function t(t,n){var r=e.call(this,t,new es(n._repo,n._path,new Br,!1))||this;return r.database=t,r._delegate=n,r}return ve(t,e),t.prototype.getKey=function(){return Je("Reference.key",0,0,arguments.length),this._delegate.key},t.prototype.child=function(e){return Je("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new t(this.database,us(this._delegate,e))},t.prototype.getParent=function(){Je("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new t(this.database,e):null},t.prototype.getRoot=function(){return Je("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)},t.prototype.set=function(e,t){Je("Reference.set",1,2,arguments.length),Ze("Reference.set","onComplete",t,!0);var n=hs(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},t.prototype.update=function(e,t){if(Je("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Jt("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_a("Reference.update",this._delegate._path),Ze("Reference.update","onComplete",t,!0);var i=fs(this._delegate,e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i},t.prototype.setWithPriority=function(e,t,n){Je("Reference.setWithPriority",2,3,arguments.length),Ze("Reference.setWithPriority","onComplete",n,!0);var r=ds(this._delegate,e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r},t.prototype.remove=function(e){Je("Reference.remove",0,1,arguments.length),Ze("Reference.remove","onComplete",e,!0);var t=cs(this._delegate);return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},t.prototype.transaction=function(e,t,n){var r=this;Je("Reference.transaction",1,3,arguments.length),Ze("Reference.transaction","transactionUpdate",e,!1),Ze("Reference.transaction","onComplete",t,!0),ya("Reference.transaction","applyLocally",n,!0);var i=iu(this._delegate,e,{applyLocally:n}).then((function(e){return new au(e.committed,new su(r.database,e.snapshot))}));return t&&i.then((function(e){return t(null,e.committed,e.snapshot)}),(function(e){return t(e,!1,null)})),i},t.prototype.setPriority=function(e,t){Je("Reference.setPriority",1,2,arguments.length),Ze("Reference.setPriority","onComplete",t,!0);var n=ps(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},t.prototype.push=function(e,n){var r=this;Je("Reference.push",0,2,arguments.length),Ze("Reference.push","onComplete",n,!0);var i=ls(this._delegate,e),o=i.then((function(e){return new t(r.database,e)}));n&&o.then((function(){return n(null)}),(function(e){return n(e)}));var a=new t(this.database,i);return a.then=o.then.bind(o),a.catch=o.catch.bind(o,void 0),a},t.prototype.onDisconnect=function(){return _a("Reference.onDisconnect",this._delegate._path),new ou(new Za(this._delegate._repo,this._delegate._path))},Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),t}(uu),cu=function(){function e(e,t){var n=this;this._delegate=e,this.app=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return e.prototype.useEmulator=function(e,t,n){void 0===n&&(n={}),Zs(this._delegate,e,t,n)},e.prototype.ref=function(e){if(Je("database.ref",0,1,arguments.length),e instanceof lu){var t=ss(this._delegate,e.toString());return new lu(this,t)}t=as(this._delegate,e);return new lu(this,t)},e.prototype.refFromURL=function(e){var t="database.refFromURL";Je(t,1,1,arguments.length);var n=ss(this._delegate,e);return new lu(this,n)},e.prototype.goOffline=function(){return Je("database.goOffline",0,0,arguments.length),eu(this._delegate)},e.prototype.goOnline=function(){return Je("database.goOnline",0,0,arguments.length),tu(this._delegate)},e.ServerValue={TIMESTAMP:nu,increment:function(e){return function(e){return{".sv":{increment:e}}}(e)}},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hu=Object.freeze({__proto__:null,forceLongPolling:function(){kn.forceDisallow(),Tn.forceAllow()},forceWebSockets:function(){Tn.forceDisallow()},isWebSocketsAvailable:function(){return kn.isAvailable()},setSecurityDebugCallback:function(e,t){e._delegate._repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){!function(e,t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var n;t?(e.statsListener_||(e.statsListener_=new ni(e.stats_)),n=e.statsListener_.get()):n=e.stats_.get();var r=Object.keys(n).reduce((function(e,t){return Math.max(t.length,e)}),0);sn(n,(function(e,t){for(var n=e,i=e.length;i<r+2;i++)n+=" ";console.log(n+t)}))}}(e._delegate._repo,t)},statsIncrementCounter:function(e,t){!function(e,t){var n,r;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */e.stats_.incrementCounter(t),n=e.statsReporter_,r=t,n.statsToReport_[r]=!0}(e._delegate._repo,t)},dataUpdateCount:function(e){return e._delegate._repo.dataUpdateCount},interceptServerData:function(e,t){return function(e,t){e.interceptServerDataCallback_=t}(e._delegate._repo,t)},initStandalone:function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,o=e.namespace,a=e.nodeAdmin,s=void 0!==a&&a;Ot(r);var u=new it("auth-internal",new at("database-standalone"));return u.setComponent(new rt("auth-internal",(function(){return i}),"PRIVATE")),{instance:new cu(Js(t,u,void 0,n,s),t),namespace:o}}}),pu=Zn;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zn.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Zn.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var du,fu=Nn,_u=yn,vu=Object.freeze({__proto__:null,DataConnection:pu,RealTimeConnection:fu,hijackHash:function(e){var t=Zn.prototype.put;return Zn.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){Zn.prototype.put=t}},ConnectionTarget:_u,queryIdentifier:function(e){return e._delegate._queryIdentifier},forceRestClient:function(e){!function(e){Gs=e}(e)}}),yu=cu.ServerValue;Ot((du=Rt).SDK_VERSION),du.INTERNAL.registerComponent(new rt("database",(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return new cu(Js(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:lu,Query:uu,Database:cu,DataSnapshot:su,enableLogging:$t,INTERNAL:hu,ServerValue:yu,TEST_ACCESS:vu}).setMultipleInstances(!0)),du.registerVersion("@firebase/database","0.10.9");const gu=e=>({}),mu=e=>({copy:e[2]});function wu(e){let t,n,r;const i=e[4].default,o=s(i,e,e[3],mu);return{c(){o&&o.c(),t=b(),n=g("textarea"),this.h()},l(e){o&&o.l(e),t=N(e),n=k(e,"TEXTAREA",{class:!0}),I(n).forEach(y),this.h()},h(){n.value=e[0],T(n,"class","svelte-w8w2mp")},m(i,a){o&&o.m(i,a),v(i,t,a),v(i,n,a),e[5](n),r=!0},p(e,[t]){o&&o.p&&(!r||8&t)&&c(o,i,e,e[3],r?l(i,e[3],t,gu):h(e[3]),mu),(!r||1&t)&&(n.value=e[0])},i(e){r||(ne(o,e),r=!0)},o(e){re(o,e),r=!1},d(r){o&&o.d(r),r&&y(t),r&&y(n),e[5](null)}}}function bu(e,t,n){let{$$slots:r={},$$scope:i}=t;const o=q();let a,{text:s}=t;return e.$$set=e=>{"text"in e&&n(0,s=e.text),"$$scope"in e&&n(3,i=e.$$scope)},[s,a,async function(){a.select(),document.execCommand("Copy"),await($(),V),a.blur(),o("copy")},i,r,function(e){U[e?"unshift":"push"]((()=>{a=e,n(1,a)}))}]}class Cu extends pe{constructor(e){super(),he(this,e,bu,wu,a,{text:0})}}const Eu=/[a-zA-Z]/,Tu=(e,t=0)=>[...Array(e).keys()].map((e=>e+t));function Iu(e,t,n){const r=e.slice();return r[6]=t[n],r}function Su(e){let t;return{c(){t=g("div"),this.h()},l(e){t=k(e,"DIV",{class:!0,style:!0}),I(t).forEach(y),this.h()},h(){T(t,"class","circle svelte-h1a2xs"),A(t,"animation",e[2]+" "+(1===e[6]?`${(e[5]-.1)/2}${e[4]}`:"0s")+" infinite ease-in-out")},m(e,n){v(e,t,n)},p(e,n){4&n&&A(t,"animation",e[2]+" "+(1===e[6]?`${(e[5]-.1)/2}${e[4]}`:"0s")+" infinite ease-in-out")},d(e){e&&y(t)}}}function ku(t){let n,r=Tu(2,1),i=[];for(let e=0;e<r.length;e+=1)i[e]=Su(Iu(t,r,e));return{c(){n=g("div");for(let e=0;e<i.length;e+=1)i[e].c();this.h()},l(e){n=k(e,"DIV",{class:!0,style:!0});var t=I(n);for(let n=0;n<i.length;n+=1)i[n].l(t);t.forEach(y),this.h()},h(){T(n,"class","wrapper svelte-h1a2xs"),A(n,"--size",t[3]+t[1]),A(n,"--color",t[0])},m(e,t){v(e,n,t);for(let r=0;r<i.length;r+=1)i[r].m(n,null)},p(e,[t]){if(52&t){let o;for(r=Tu(2,1),o=0;o<r.length;o+=1){const a=Iu(e,r,o);i[o]?i[o].p(a,t):(i[o]=Su(a),i[o].c(),i[o].m(n,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}10&t&&A(n,"--size",e[3]+e[1]),1&t&&A(n,"--color",e[0])},i:e,o:e,d(e){e&&y(n),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(i,e)}}}function Pu(e,t,n){let{color:r="#FF3E00"}=t,{unit:i="px"}=t,{duration:o="2.1s"}=t,{size:a="60"}=t,s=o.match(Eu)[0],u=o.replace(Eu,"");return e.$$set=e=>{"color"in e&&n(0,r=e.color),"unit"in e&&n(1,i=e.unit),"duration"in e&&n(2,o=e.duration),"size"in e&&n(3,a=e.size)},[r,i,o,a,s,u]}class Nu extends pe{constructor(e){super(),he(this,e,Pu,ku,a,{color:0,unit:1,duration:2,size:3})}}export{F as A,t as B,fe as C,s as D,O as E,c as F,h as G,l as H,_ as I,e as J,R as K,E as L,i as M,Rt as N,Cu as O,m as P,o as Q,Nu as R,pe as S,ie as T,I as a,T as b,k as c,y as d,g as e,v as f,P as g,x as h,he as i,se as j,b as k,C as l,ue as m,N as n,le as o,oe as p,ae as q,ee as r,a as s,w as t,re as u,ce as v,te as w,ne as x,j as y,M as z};
